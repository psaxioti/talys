29/02/04                                                                ecis-000
               description of input of ecis03                           ecis-001
               ******************************                           ecis-002
                                                                        ecis-003
                                                                        ecis-004
                                                                        ecis-005
cards read in subroutine calx                                           ecis-006
*****************************                                           ecis-007
                                                                        ecis-008
card 1                                  format (18a4)                   ecis-009
******                                                                  ecis-010
      title of the run which will be printed as heading of results.     ecis-011
                                                                        ecis-012
      if title='description ' this input description is listed.         ecis-013
         (1829 lines correctly printed in 31 pages)                     ecis-014
          after this listing, go back to card 1.                        ecis-015
                                                                        ecis-016
      if title='fin ' the calculation is stopped.                       ecis-017
                                                                        ecis-018
           these control words must be punched from column 1.           ecis-019
                                                                        ecis-020
card 2                                  format (50l1)                   ecis-021
******                                                                  ecis-022
      50 first logical controls lo. enter 't' in the corresponding      ecis-023
      column for .true. and nothing for .false..                        ecis-024
                                                                        ecis-025
 model                                                                  ecis-026
       1- lo(1)  rotational model-(inverse: vibrational model).         ecis-027
       2- lo(2)  second order vibrational model-(inverse: first order). ecis-028
                 or constrained asymmetric rotational model (band mixingecis-029
                 parameters of the first two 2+ computed from the       ecis-030
                 quadrupole 'gamma' in the davydov-filippov model).     ecis-031
       3- lo(3)  anharmonic vibrational model-(inverse: harmonic) or    ecis-032
                 asymmetric rotational model-(inverse: symmetric).      ecis-033
       4- lo(4)  parametrised spin-orbit deformation-(inverse: standard)ecis-034
       5- lo(5)  different deformation for each potential-(inverse: sameecis-035
                 deformation).                                          ecis-036
       6- lo(6)  deformation lengths read instead of deformations for   ecis-037
                 woods-saxon form factors.                              ecis-038
       7- lo(7)  nuclear matrix element and form factors read on cards. ecis-039
                 this is not allowed for schroedinger equivalent of     ecis-040
                 dirac equation. with spin in some channel and no       ecis-041
                 coulomb spin-orbit, use also lo(46)=.true..            ecis-042
       8- lo(8)  relativistic kinematics (reduced mass replaced by      ecis-043
                 similar formula with relativistic energies).           ecis-044
       9- lo(9)  symmetric woods-saxon form factors when the radius is  ecis-045
                 negative.                                              ecis-046
      10- lo(10) energy dependent potentials by dispersion relations.   ecis-047
                 not allowed with external potentials (lo(7)=.true.).   ecis-048
                                                                        ecis-049
 interaction                                                            ecis-050
      11- lo(11) deformed coulomb potential. with lo(7)=.false., it is  ecis-051
                 set .false. by the code if no charge is read.          ecis-052
      12- lo(12) deformed imaginary potential (volume and surface or    ecis-053
                 scalar and vector).                                    ecis-054
      13- lo(13) deformed real spin-orbit or tensor potential. with     ecis-055
                 lo(7)=.false., it is set .false. by the code if no     ecis-056
                 non zero spin and no related potential are read.       ecis-057
      14- lo(14) deformed imaginary spin-orbit or tensor potential. if  ecis-058
                 .true., lo(13) is set .true.. with lo(7)=.false., it isecis-059
                 set .false. by the code as for lo(13).                 ecis-060

      15- lo(15) reduced nuclear matrix elements read from cards.       ecis-061
                 it is necessary for the anharmonic vibrational model.  ecis-062
      16- lo(16) heavy-ion definition of reduced radii and deformations.ecis-063
                 when there are different masses in different channels, ecis-064
                 the masses to be used can be indicated by the first    ecis-065
                 input, but only the masses of the first level can be   ecis-066
                 used for the back transformation of the results of a   ecis-067
                 search or in the subroutine eval (lo(37)=.true.).      ecis-068
                 if lo(6)=.true., only coulomb deformation lengths are  ecis-069
                 changed.                                               ecis-070
      17- lo(17) folding model. with external form factors the folding  ecis-071
                 parameters are used independently of this logical.     ecis-072
      18- lo(18) projectile-target antisymmetrisation, valid only for   ecis-073
                 same spin of the particle and the target and positive  ecis-074
                 parity in the schroedinger formalism. for spin 0,      ecis-075
                 the s-matrix is computed only for even total spins.    ecis-076
                 for spin non 0., the amplitudes are symmetrised but    ecis-077
                 this do not correct the lack of symmetry of the        ecis-078
                 interaction between particle and target.               ecis-079
      19- lo(19) deformed coulomb spin-orbit potential. if .true.,      ecis-080
                 lo(11) is set .true.. with lo(7)=.false., it is set    ecis-081
                 .false. by the code as for lo(13). (needs lo(13)=.true.ecis-082
                 with a real spin-orbit potential, even very small)     ecis-083
      20- lo(20) energy dependence of transition form-factors when      ecis-084
                 lo(10)=.true. . this dependence is the geometric mean  ecis-085
                 value of the dependence of the levels between which    ecis-086
                 the transition form-factor occurs. it cannot be used   ecis-087
                 with lo(12)=.false. .                                  ecis-088
  note:  in the rotational models, the optical potentials (for elastic  ecis-089
  ****  scattering) are always deformed. to avoid this, when lo(11),    ecis-090
        lo(12),lo(13),lo(14) or lo(19) is .false., use lo(5)=.true.     ecis-091
        and enter 0. for the corresponding deformations.                ecis-092
                                                                        ecis-093
 integration                                                            ecis-094
      21- lo(21) usual coupled equations-(inverse: iterations).         ecis-095
                 not allowed with dirac equation. when it is used with  ecis-096
                 deformed spin-orbit, the derivative terms are not takenecis-097
                 into account and the computation is incorrect.         ecis-098
      22- lo(22) no use of pade approximants for convergence of the     ecis-099
                 iterations.                                            ecis-100
      23- lo(23) no use of pade approximant results and shift to usual  ecis-101
                 coupled equations when convergence is not obtained.    ecis-102
      24- lo(24) computation of coupling potentials at each iteration.  ecis-103
                 (saves space but loses time, chiefly in rotational     ecis-104
                 model).                                                ecis-105
      25- lo(25) complete calculation up to the end-(inverse: one       ecis-106
                 iteration only as soon as two iterations are enough).  ecis-107
      26- lo(26) stabilisation of integration for long range constant   ecis-108
                 potentials. an additional term in h**6 is introduced inecis-109
                 the truncation in such a way that the term in h**6 of  ecis-110
                 the total truncation error cancels out for a constant  ecis-111
                 potential.                                             ecis-112
      27- lo(27) numerov's method for single equations-(inverse:        ecis-113
                 modified numerov's method). for single equation and    ecis-114
                 constant potential, truncation errors are of opposite  ecis-115
                 sign.                                                  ecis-116
      28- lo(28) computation up to j-convergence-(inverse: stop when allecis-117
                 the inhomogeneous terms are negligible). for elastic   ecis-118
                 scattering (only one channel) lo(21) or lo(28) must be ecis-119
                 .true.. in this case lo(28) is set .true. by the code. ecis-120

      29- lo(29) no diagonal terms in second members for iterations of  ecis-121
                 schroedinger equations. (inverse: all couplings are in ecis-122
                 second members. the uncoupled solutions do not depend  ecis-123
                 on the channel spin but convergence can be slower in   ecis-124
                 some problems. no effect in first order vibrational    ecis-125
                 model, no use in dirac equations: if lo(100)=.true.,   ecis-126
                 lo(29) is set .false.). for convenience, lo(29) is set ecis-127
                 .false. if lo(18)=.true. .                             ecis-128
                                                                        ecis-129
 search                                                                 ecis-130
      31- lo(31) input of experimental data and calculation of a chi2.  ecis-131
                 it is set .false. if no experimental data are read.    ecis-132
      32- lo(32) automatic search on some parameters. it is set .false. ecis-133
                 if no parameters are in search.                        ecis-134
      33- lo(33) symmetrised chi2 for cross-sections with fixed         ecis-135
                 normalisation-(inverse: usual chi2). the chi2          ecis-136
                 contribution is multiplied by the ratio of             ecis-137
                 experimental to calculated value.                      ecis-138
      34- lo(34) number of evaluations in the search limited by the job ecis-139
                 card. this option can be used only if the remaining    ecis-140
                 cpu time is available to the code on your computer.    ecis-141
                 a maximum running time must be read.                   ecis-142
      35- lo(35) search saved on tape 8 if correctly ended or stopped byecis-143
                 the number of evaluations.                             ecis-144
      36- lo(36) restart a search from tape 8.                          ecis-145
      37- lo(37) next calculation changing only energy and some optical ecis-146
                 parameters.                                            ecis-147
                                                                        ecis-148
 long range interaction                                                 ecis-149
      41- lo(41) factorisation of 1/(1-cos(theta)) in the amplitudes. itecis-150
                 is needed for dirac equation or with spin-orbit coulombecis-151
                 potential.                                             ecis-152
      42- lo(42) schmidt's orthogonalisation of solutions in usual      ecis-153
                 coupled equations.                                     ecis-154
      43- lo(43) interpolation on total spin.                           ecis-155
      44- lo(44) coulomb corrections. lo(44) is set .false. if lo(11) isecis-156
                 .false. . outside the dirac formalism it is better to  ecis-157
                 use also lo(29)=.true..                                ecis-158
      45- lo(45) limitation on the angular momenta for coulomb          ecis-159
                 corrections. default options are 3 for central term    ecis-160
                 and 2 for spin-orbit term. maximum values are          ecis-161
                 respectively 5 and 4.                                  ecis-162
      46- lo(46) restricted coulomb corrections. (saves storage).       ecis-163
                 if lo(44)=.false. the diagonal corrections used in     ecis-164
                 dirac formalism or for the coulomb spin-orbit are      ecis-165
                 suppressed. if lo(44)=.true. indications for these     ecis-166
                 restrictions between channels will be read.            ecis-167
  note:  if lo(36)=.true. a search saved on tape 8 is restarted;        ecis-168
  ****  no other logical control from this card is taken into account.  ecis-169
        instead of the following cards, go to 'restart input: cards     ecis-170
        read in subroutine rest'.                                       ecis-171
                                                                        ecis-172
card 3                                  format (50l1)                   ecis-173
******                                                                  ecis-174
      logical controls from 51 to 100 (as for previous card).           ecis-175
                                                                        ecis-176
 printing in complete output                                            ecis-177
       1- lo(51) output of potentials.                                  ecis-178
       2- lo(52) output of reduced nuclear matrix elements.             ecis-179
       3- lo(53) output of the number of iterations.                    ecis-180

       4- lo(54) output of the length used in the working field.        ecis-181
       5- lo(55) output of c-matrix elements and of compound nucleus    ecis-182
                 intermediate results.                                  ecis-183
       6- lo(56) output of s-matrix elements                            ecis-184
       7- lo(57) output of phase-shifts at each e.c.i.s. iteration.     ecis-185
       8- lo(58) output of the coefficients of each form factor for all ecis-186
                 sets of equations.                                     ecis-187
  note:  in a search, lo(51) to lo(58) are used for the complete resultsecis-188
  ****  (at the first calculation if lo(75)=.false. and at the end of   ecis-189
        the search).                                                    ecis-190
                                                                        ecis-191
 punch and results in last output                                       ecis-192
       9- lo(59) for neutron scattering, total reaction, elastic and    ecis-193
                 reaction cross-section written on file 58. for charged ecis-194
                 particles, reaction cross-section written on file 58.  ecis-195
                 inelastic cross-sections written on file 59.           ecis-196
      10- lo(60) s-matrix elements written on file 60.                  ecis-197
      11- lo(61) reduced nuclear matrix elements written on file 61.    ecis-198
      12- lo(62) potentials written on file 62.                         ecis-199
      13- lo(63) penetrabilities written on file 63. with iterations,   ecis-200
                 the code computes all the solutions.                   ecis-201
      14- lo(64) results for experimental data on file 64 and at        ecis-202
                 equidistant angles written on file 66.                 ecis-203
      15- lo(65) coefficients of the expansion in legendre polynomials  ecis-204
                 written on file 65.                                    ecis-205
  note:  in a search,lo(59) to lo(65) are used only in the last result. ecis-206
  ****  there are introduced for neutron scattering, in peculiar, on theecis-207
        suggestion of e. bauge, r. capote and a. koning. foe each run,  ecis-208
        the first line (format a10,,f10.2,f10.5,f10.2,2i5) with the     ecis-209
    1-10  identification <cross-s.>, <ine.c.s.>, <s-matrix>, <red.mat.>,ecis-210
          <potenti.>, <tlj     >, <exp.dat.>, <legendre>, <ang.dis.> forecis-211
          files 58 to 66.                                               ecis-212
   11-20 the mass of the incident particle.                             ecis-213
   21-30 the energy in the laboratory system.                           ecis-214
   31-40 the mass of the target.                                        ecis-215
   41-45 the product of charges.                                        ecis-216
   46-50 the number of lines or the number of subsets which are headed  ecis-217
         by some indications including their own number of lines, exceptecis-218
         for 61 and 62. for 61, it is the number of coupled states and  ecis-219
         the remaining of the output can be used by the program.        ecis-220
         for 62, it is the number of form-factors and the remaining of  ecis-221
         the output can also be used by the program, replacing the      ecis-222
         identifications by the suitable input.                         ecis-223
                                                                        ecis-224
 printing in the last result                                            ecis-225
      16- lo(66) no calculation at equidistant angles.                  ecis-226
      17- lo(67) no plot of experimental data.                          ecis-227
      18- lo(68) no plot of cross-sections at equidistant angles.       ecis-228
      19- lo(69) no plot of polarisations at equidistant angles.        ecis-229
                                                                        ecis-230
 printing at the beginning and in a search                              ecis-231
      21- lo(71) detailed output of logical controls.                   ecis-232
      22- lo(72) no output of experimental data when they are read.     ecis-233
      23- lo(73) no output of external potentials when they are read.   ecis-234
      24- lo(74) output of time in different steps of computation.      ecis-235
      25- lo(75) no complete output at the first run of a search.       ecis-236
      26- lo(76) lo(51) to lo(65) are always used-(inverse: only for    ecis-237
                 complete output).                                      ecis-238
      27- lo(77) no output of time differences during the search.       ecis-239
      28- lo(78) no output of differences between experimental and      ecis-240
                 calculated values.                                     ecis-241
                                                                        ecis-242

 compound nucleus                                                       ecis-243
      31- lo(81) hauser-feshbach corrections to cross-sections.         ecis-244
                 with iterations, the code computes all the solutions.  ecis-245
                 if lo(82), lo(84), lo(85) or lo(86) is .true., lo(81)  ecis-246
                 is set .true..                                         ecis-247
      32- lo(82) old simplified compound nucleus (excludes uncoupled    ecis-248
                 states, fission and gammas; lo(84), lo(85), lo(86) are ecis-249
                 set .false.).                                          ecis-250
      33- lo(83) no engelbretch-weidenmuller transformation in compound ecis-251
                 nucleus.                                               ecis-252
      34- lo(84) uncoupled levels for compound nucleus. it is set       ecis-253
                 .false. if none are read.                              ecis-254
      35- lo(85) fission transmission coefficients (to be read from     ecis-255
                 cards) for compound nucleus. it is set .false. if none ecis-256
                 are read.                                              ecis-257
      36- lo(86) gamma emission in compound nucleus.                    ecis-258
      37- lo(87) no width fluctuations.                                 ecis-259
                                                                        ecis-260
 miscellaneous                                                          ecis-261
      41- lo(91) angular distribution at equidistant angles in the      ecis-262
                 laboratory system                                      ecis-263
      42- lo(92) pure dwba calculation.                                 ecis-264
      43- lo(93) no recoil correction for reactions.                    ecis-265
      44- lo(94) non standard observables at equidistant angles.        ecis-266
      48- lo(98) use of rest mass in dirac equation.                    ecis-267
      49- lo(99) schroedinger equivalent to dirac equation. diffuseness ecis-268
                 of coulomb potentials must be 0. lo(11) and lo(19) are ecis-269
                 set .false.. no asymmetric rotational model and no     ecis-270
                 second order vibrational model: the corresponding      ecis-271
                 logical are set .false..                               ecis-272
      50- lo(100) complete dirac equation.                              ecis-273
                                                                        ecis-274
card 4                                  format (14i5)                   ecis-275
******                                                                  ecis-276
       1- 5   ncoll  number of nuclear states. it does not include the  ecis-277
                     number of uncoupled states for compound nucleus.   ecis-278
       6-10   njmax  maximum number of channel spin. (default option 20)ecis-279
                     the maximum value of the total angular momentum j  ecis-280
                     will be njmax-1 when it is integer or njmax-.5 whenecis-281
                     it is half-integer.                                ecis-282
      11-15   iterm  maximum number of ecis iterations. (default option ecis-283
                     20). must be 1 for dwba calculations.              ecis-284
      16-20   npp    number of optical potentials. (default option 1).  ecis-285
                     the first one is deformed when the form factors    ecis-286
                     are not read on cards.                             ecis-287
      21-25   ncj    number of factorisations of 1/(1-cos(theta)) in    ecis-288
                     the amplitudes. (default option 1).                ecis-289
      26-30   ngr(1) number of decades in logarithmic scale in plots of ecis-290
                     elastic cross-sections in the standard option      ecis-291
                     (default option 2). for charged particles, the     ecis-292
                     cross-section divided by rutherford's cross-sectionecis-293
                     is plotted.                                        ecis-294
      31-35   ngr(2) as ngr(1),for inelastic channels.(default option 2)ecis-295
      36-40   npr(1) plot indications for elastic polarisations at      ecis-296
                     equidistant angles. if there are n different       ecis-297
                     angular distributions of polarisations, npr(1) is  ecis-298
                     the sum for i=1 to n of k(i)*(2**(i-1)) where      ecis-299
                     k(i)=1 for a plot and 0 for no plot of the i-th    ecis-300
                     distribution.(default option 1)                    ecis-301
              standard options: spin 0 - no polarisation.               ecis-302
                                spin 1/2 - vector polarisation.         ecis-303
                                spin >1/2 - it11, t20, t21, t22.        ecis-304

      41-45   npr(2) as npr(1),for inelastic channels.(default option 1)ecis-305
              standard options: spin 0 - no polarisation.               ecis-306
                      spin 1/2 - vect. ana. power, vect. pol., spin-flipecis-307
                      spin >1/2 - it11, vect. pol., t20, t21, t22.      ecis-308
      46-50   lmz    number of j values for which the radial equations  ecis-309
                     are solved when coulomb corrections are used. this ecis-310
                     number can be automatically decreased if the       ecis-311
                     irregular functions are too large. the asymptotic  ecis-312
                     region where the phase-shifts are computed         ecis-313
                     analytically is above this value. the best value ofecis-314
                     lmz is the maximum value of j needed by the same   ecis-315
                     computation without charge and without anomalous   ecis-316
                     magnetic moment. (default option njmax/2, but enterecis-317
                     a negative value if you want to use njmax).        ecis-318
      51-55   jdm    total spin above which stop or reduction to one    ecis-319
                     iteration can occur. (limits lo(25),lo(28)=.false.)ecis-320
      56-60   lml    maximum angular momentum (default option maximum). ecis-321
                     without long range interaction, a limit is given   ecis-322
                     for each level such that the regular coulomb       ecis-323
                     function is larger than 1.d-30 at matching radius. ecis-324
      61-65   jit    number of rates of interpolation for total spin.   ecis-325
                     (default value 1).                                 ecis-326
      66-70   mn     multiplicative factor for njmax read in columns    ecis-327
                     6-10 allowing to use more than njmax>10**5.        ecis-328
                     (default value 1)                                  ecis-329
  note:  if lo(94)=.true. ngr and npr are not taken into account in     ecis-330
  ****  computations at equidistant angles because such indications willecis-331
        be read again, but ngr is always used for plots of experimental ecis-332
        cross-sections.                                                 ecis-333
                                                                        ecis-334
card 5                                  format (7f10.5)                 ecis-335
******                                                                  ecis-336
        1-10   h     integration step size in fermis. (default option   ecis-337
                     min(0.5/wave number, 0.5*min(diffusenesses)),      ecis-338
                     without the diffusenesses if lo(7)=.true.).        ecis-339
       11-20   rm    matching radius.(if lo(7)=.true. default option 20.ecis-340
                     if lo(7)=.false., for each non zero potential, the ecis-341
                     radius where its absolute value is (aconv*ecm/wave ecis-342
                     number) is computed and rm is the largest of them. ecis-343
                     for coulomb form factors, radius+10*diffuseness is ecis-344
                     used)                                              ecis-345
       21-30   bjm   coefficient of the imaginary potential to be added ecis-346
                     to the uncoupled equations and removed in the      ecis-347
                     second member to accelerate convergence for        ecis-348
                     schroedinger equations.                            ecis-349
       31-40   eiter convergence criterion for s-matrix in the iterationecis-350
                     (default option 1.d-5).                            ecis-351
       41-50   aconv value below which functions and potentials are     ecis-352
                     neglected in iterations.(default option 1.d-5).    ecis-353
                     aconv is also used in the default value of rm.     ecis-354
       51-60   conj  convergence criterion for j values.                ecis-355
                     (default option 1.d-5).                            ecis-356
                                                                        ecis-357
limitation of job time                  format (14i5)                   ecis-358
**********************                                                  ecis-359
  if lo(34) is .true., otherwise go to 'limitation to coulomb corr... ' ecis-360
       1- 5   msec   time allowed for the job in seconds, used only for ecis-361
                     a search limited by this time. (default value 3600)ecis-362
       6-10   nsec   time needed at the end of a search to print final  ecis-363
                     results in hundredths of second.(default value 100)ecis-364
                                                                        ecis-365

limitation to coulomb corrections       format (14i5)                   ecis-366
*********************************                                       ecis-367
  if lo(45) is .true., otherwise go to 'legendre expansion data'        ecis-368
       1- 5   mcm(1)  maximum angular momentum for the computation of   ecis-369
                      the corrections due to the coulomb potential.     ecis-370
                      (default option 3, value limited to 5).           ecis-371
       6-10   mcm(2)  same for the spin-orbit coulomb potential.        ecis-372
                      (default option 2, value limited to 4).           ecis-373
 note:  enter a negative value to use 0. a blank or 0 is replaced by    ecis-374
 *****  the default options described above.                            ecis-375
                                                                        ecis-376
legendre expansion data                 format (14i5)                   ecis-377
***********************                                                 ecis-378
  if lo(65) is .true., otherwise go to 'compound nucleus data'.         ecis-379
       1- 5   nl(1)  power of (1-cos(theta)) for the expansion in       ecis-380
                     legendre polynomials of the interference between   ecis-381
                     coulomb and nuclear elastic scattering. power of   ecis-382
                     (1-cos(theta)**2) if lo(18) is .true..             ecis-383
                     (default option 2).                                ecis-384
       6-10   nl(2)  number of legendre polynomials for elastic         ecis-385
                     scattering of charged particles. (default option   ecis-386
                     1.5 number obtained without coulomb amplitude).    ecis-387
      11-15   nl(3)  number of legendre polynomials for elastic         ecis-388
                     scattering of uncharged particles, inelastic       ecis-389
                     scattering and compound nucleus. (default option   ecis-390
                     maximum number).                                   ecis-391
                                                                        ecis-392
compound nucleus data                   format (8i5,2f10.5)             ecis-393
*********************                                                   ecis-394
  if lo(84) or lo(85) or lo(86) is .true., otherwise go to              ecis-395
  'interpolation on total spin'.                                        ecis-396
       1- 5   nsp(1) number of uncoupled states and continua. if is     ecis-397
                     replaced by min(nsp(1),nsp(2)). if it is zero,     ecis-398
                     lo(84)=.false.                                     ecis-399
       6-10   nsp(2) number of uncoupled states with angular            ecis-400
                     distribution. they must be the first given.        ecis-401
      11-15   nfiss  number of fission data. if nfiss=0, lo(85)=.false. ecis-402
      16-20   nrd    number of gamma transmission factors. if it is 0,  ecis-403
                     these coefficients are computed.                   ecis-404
      21-25   ncont  number of continua. they must be the last given,   ecis-405
                     no angular distribution can be requested for them. ecis-406
      26-30   ncoj   number of values of the spin of the residual       ecis-407
                     nucleus for the continua. (default option 30).     ecis-408
      31-35   kmin   minimum number of j values for compound nucleus    ecis-409
                     (default option: minimum value for s waves in      ecis-410
                     entrance channel).                                 ecis-411
      36-40   kmax   maximum number of j values for compound nucleus    ecis-412
                     (default option njmax).                            ecis-413
      41-50   acn1   ratio energy/step for the discretisation of the    ecis-414
                     continua at large energy . (default option 8.).    ecis-415
      51-60   acn2   number of steps per mev for the discretisation of  ecis-416
                     the continua at low energy. (default option 8.).   ecis-417
  note:  the shift from the use of acn1 to acn2 occurs below the energy ecis-418
  ****  acn1/acn2. below this energy, the interval is divided in equal  ecis-419
    steps with a minimum of two steps. calculations are done with the   ecis-420
    energy of the middle of the step.                                   ecis-421
         without kmin the calculation can stop before any significant   ecis-422
    result. with interpolation on total spin below kmax, a huge storage ecis-423
    array, proportional to kmax, is needed for uncoupled states with    ecis-424
    angular distribution.                                               ecis-425

         compound nucleus calculation is stopped at the j value larger  ecis-426
    than kmin one for which the largest compound nucleus contribution isecis-427
    less than conj**2. the code cannot deal with very large j values.   ecis-428
                                                                        ecis-429
interpolation on total spin             format (14i5)                   ecis-430
***************************                                             ecis-431
  if lo(43) is .true., otherwise go to  'cards read in subroutine lect'.ecis-432
        1- 5   ls(1) first limit.                                       ecis-433
        6-10   ld(1) number of values skipped.                          ecis-434
       11-15   ls(2) second limit.                                      ecis-435
       16-20   ld(2) number of values skipped.                          ecis-436
   ....................  up to ls(jit) and ld(jit)   ...................ecis-437
       the calculation is stopped if values ls decrease. the values ld  ecis-438
 are changed to be used cumulatively in the program. if lo(18)=.true.,  ecis-439
 and the spins in the ground state are both zero, the values ld read areecis-440
 multiplied by 2.                                                       ecis-441
                                                                        ecis-442
                                                                        ecis-443
cards read in subroutine lecl                                           ecis-444
*****************************                                           ecis-445
                                                                        ecis-446
for each nuclear state:                                                 ecis-447
***********************                                                 ecis-448
      beginning with the ground-state and including uncoupled states forecis-449
      compound nucleus calculation which must be at the end.            ecis-450
      the best order is the one of decreasing coupling strength.        ecis-451
                                                                        ecis-452
nuclear states -spins and masses -      format (f5.2,2i2,a1,5f10.5)     ecis-453
***********************************                                     ecis-454
       1- 5   sp2: spin of the target (2*sp2+1 kept in ipi(3,i)).       ecis-455
       6- 7   n:   further description of the state.                    ecis-456
              in the rotational model, must be non-zero for the member  ecis-457
                      of a vibrational band.                            ecis-458
              in the vibrational model, can be non-zero for the ground  ecis-459
                      state to avoid the input of next card.            ecis-460
              not used if lo(3) = .true. (anharmonic vibrational  model ecis-461
                      or asymmetric rotational model), if lo(7) = .true.ecis-462
                      (external potentials) and uncoupled states.       ecis-463
       8- 9   k:   optical potential. (default option,1 for ground-stateecis-464
                   and same as last one for excited state).             ecis-465
         10   spi: parity of the nuclear state: '+' or '-' but only '-' ecis-466
                   is needed ('+' for a blank or any other character).  ecis-467
                   this data is kept as 0 or 1 in ipi(1,i).             ecis-468
      11-20   energy of the projectile in the laboratory system in mev  ecis-469
              for the ground state. excitation energy for the others.   ecis-470
      21-30   sp1: spin of the particle (2*sp1+1 kept in ipi(2,i)).     ecis-471
      31-40   wv(1,i):   mass of the projectile in a.m.u.  .            ecis-472
                   if this value is not zero for an excited state, the  ecis-473
                   spin of the projectile, its mass and the product of  ecis-474
                   charges read on this card are taken into account. if ecis-475
                   this mass is zero, values of sp1, sp2, sp3, wv(1,i)  ecis-476
                   and wv(2,i) are taken from the preceding level.      ecis-477
      41-50   wv(2,i):   mass of the target in a.m.u.  .                ecis-478
      51-60   sp3: product of the charges of the target and of the      ecis-479
                   particle (sp3 kept in ipi(4,iv)).                    ecis-480
  note:  only this card is read for uncoupled states and continua       ecis-481
  ****  used for compound nucleus calculation.                          ecis-482
                                                                        ecis-483

description of vibrations  (if n is not 0 in rotational model or n is 0 ecis-484
*************************  in vibrational model and lo(3)=lo(7)=.false.)ecis-485
                                                                        ecis-486
number of phonons                       format (14i5)                   ecis-487
*****************                                                       ecis-488
       1- 5   iph(i)  description of the state.                         ecis-489
              in the vibrational model: 0 for ground state              ecis-490
                      1 or 2 for pure 1 or 2-phonons state              ecis-491
                      3 for a mixture of 1 and 2-phonons states.        ecis-492
              in the rotational model: 0 for ground-state band          ecis-493
                                       1 for vibrational band           ecis-494
                                       2 for a mixture of them          ecis-495
       6-10   rotational model: number of the vibration in the order of ecis-496
              input. (see 'cards read in lect')                         ecis-497
              vibrational model: number of the phonon of the one-phonon ecis-498
              state or of the first phonon of the two-phonons state.    ecis-499
      11-15   vibrational model: number of the second phonon of the     ecis-500
              two-phonons state.                                        ecis-501
      16-20   vibrational model: number of the one-phonon component of  ecis-502
              a mixed state.                                            ecis-503
  note:  the total number of phonons will be the largest number read    ecis-504
  ****  in the columns 6 to 20.                                         ecis-505
                                                                        ecis-506
phonons mixing parameter                format (7f10.5)                 ecis-507
************************                                                ecis-508
  if iph is 3 (vibrational model) or iph is 2 (rotational model)        ecis-509
       1-10   bt in degrees.                                            ecis-510
      the nuclear state is:  cos(bt)*(1 phonon) + sin(bt)*(2 phonons).  ecis-511
              or:  cos(bt)*(vibr. band) + sin(bt)*(ground band).        ecis-512
                                                                        ecis-513
for asymmetric rotational model                                         ecis-514
*******************************                                         ecis-515
 if lo(1)=lo(3)=.true.                                                  ecis-516
     there are n=sp(*,4)/2 band mixing parameters between the n+1 bands ecis-517
  defined as atan(a(2*i)/a(2*i-2)) where a(i) is the amplitude of band iecis-518
     if n is not 0 and the reduced matrix elements are not read on cardsecis-519
                                                                        ecis-520
mixing parameters                       format (7f10.5)                 ecis-521
*****************                                                       ecis-522
       1-10   bt(1)  in degrees.                                        ecis-523
      11-20   bt(2)  in degrees.                                        ecis-524
      21-30   bt(3)  in degrees.                                        ecis-525
      31-40   bt(4)  in degrees.                                        ecis-526
      41-50   bt(5)  in degrees.                                        ecis-527
      51-60   .................                                         ecis-528
      the nuclear state is:   cos(bt(1))*y(ai,0) + sin(bt(1))*cos(bt(2))ecis-529
      *(y(ai,2)+s*y(ai,-2))*sqrt(0.5) + sin(bt(1))*sin(bt(2))*cos(bt(3))ecis-530
      *(y(ai,4)+s*y(ai,-4))*sqrt(0.5) + ....... where s=(-)**(ai+spi).  ecis-531
  note: for unnatural parity states (spi=-), bt(1) will be ignored in   ecis-532
  **** the calculation and replaced by 90. degrees.                     ecis-533
        if lo(15)=.true., all the nuclear parameters (quantities given  ecis-534
    in degrees) have to be read in order to avoid a change in this part ecis-535
    of input when shifting lo(15) from .false. to .true..  they are not ecis-536
    used and cannot be in search.                                       ecis-537
                                                                        ecis-538
                                                                        ecis-539
cards read in subroutine lect                                           ecis-540
*****************************                                           ecis-541
                                                                        ecis-542

phonon descriptions                     format (2i5,f10.5,i5)           ecis-543
*******************                                                     ecis-544
for every phonon involved                                               ecis-545
       1- 5   nbta(9,*) = l angular momentum used also for heavy ion    ecis-546
       6-10   nbta(10,*) = k magnetic quantum number of the vibration inecis-547
                     rotational model. in the vibrational model, must beecis-548
                     zero to use this phonon in l=0 second order terms. ecis-549
      11-20   beta(1,*)   phonon amplitude for the real potential.      ecis-550
      21-25   ik   level of which the masses are used for heavy-ion     ecis-551
                     corrections. (default option ik=1).                ecis-552
                                                                        ecis-553
phonon amplitudes of other potentials   format (7f10.5)                 ecis-554
*************************************                                   ecis-555
      if deformations are not the same for all potentials (lo(5)=.true.)ecis-556
       1-10   beta(2,*) for volume imaginary potential.                 ecis-557
      11-20   beta(3,*) for surface real potential.                     ecis-558
      21-30   beta(4,*) for surface imaginary potential.                ecis-559
      31-40   beta(5,*) for real spin-orbit.                            ecis-560
      41-50   beta(6,*) for imaginary spin-orbit.                       ecis-561
      51-60   beta(7,*) for coulomb potential.                          ecis-562
      61-70   beta(8,*) for coulomb spin-orbit potential.               ecis-563
  note:  if lo(5)=.false., beta(i,*)=beta(1,*) for i=2,8.               ecis-564
  ****                                                                  ecis-565
                                                                        ecis-566
deformations of rotational model        format (2i5,f10.5,i5)           ecis-567
********************************                                        ecis-568
 only if lo(1)=.true. and lo(7)=.false., otherwise go to 'optical model ecis-569
 parameters'.                                                           ecis-570
       1- 5   iqm    largest order of deformation.                      ecis-571
       6-10   iqmax  maximum l-value of multipole expansion.            ecis-572
      11-20   aspin, the k-value of the band, used only in symmetric    ecis-573
                     rotational model.                                  ecis-574
      21-25   ik     level of which the masses are used for heavy-ion   ecis-575
                     corrections. (default option ik=1).                ecis-576
  note:  in the asymmetric rotational model iqm is limited to 35        ecis-577
  ****  and iqmax is limited to 8.                                      ecis-578
                                                                        ecis-579
deformations of real volume potential   format (7f10.5)                 ecis-580
*************************************                                   ecis-581
    iq = iqm/2 values for symmetric rotational model                    ecis-582
    iq = iqm-1 values for asymmetric rotational model                   ecis-583
       1-10   beta(1,1)  deformation of the real potential.             ecis-584
      11-20   beta(1,2)  deformation of the real potential.             ecis-585
      21-30   beta(1,3)  deformation of the real potential.             ecis-586
      31-40   beta(1,4)  deformation of the real potential.             ecis-587
      41-50   beta(1,5)  deformation of the real potential.             ecis-588
...............................                                         ecis-589
      eventually, on next card:         format (7f10.5)                 ecis-590
       1-10   beta(1,8)  deformation of the real potential.             ecis-591
      11-20   beta(1,9)  deformation of the real potential. ....        ecis-592
      ..... and so on up to beta(1,iq).                                 ecis-593
                                                                        ecis-594
deformations for other potentials       format (7f10.5)                 ecis-595
*********************************                                       ecis-596
      if deformations are not the same for all potentials (lo(5)=.true.)ecis-597
       1-10   beta(2,i) deformation of the volume imaginary potential.  ecis-598
      11-20   beta(3,i) deformation of the surface real potential.      ecis-599
      21-30   beta(4,i) deformation of the surface imaginary potential. ecis-600
      31-40   beta(5,i) deformation for the real spin-orbit.            ecis-601

      41-50   beta(6,i) deformation for the imaginary spin-orbit.       ecis-602
      51-60   beta(7,i) deformation for the coulomb potential.          ecis-603
      61-70   beta(8,i) deformation for the coulomb spin-orbit.         ecis-604
 there are iq such cards                                                ecis-605
  note:  if lo(5)=.false., beta(i,j)=beta(1,j) for i=2,6 and j=1,iq.    ecis-606
  ****                                                                  ecis-607
                                                                        ecis-608
explanation of deformations of the rotational model:                    ecis-609
****************************************************                    ecis-610
for symmetric rotational model  (lo(3)=.false.)                         ecis-611
       the order of deformation is l=2, 4, 6, ... and so on.            ecis-612
       the radial dependence of potentials is:                          ecis-613
          r = r0*(1 + beta(*,1)*y(2,0).+ beta(*,2)*y(4,0) + .....)      ecis-614
          odd order deformations are not read.                          ecis-615
                                                                        ecis-616
for the asymmetric rotational model (lo(3)=.true.)                      ecis-617
       the order of deformations are (l,k)=(2,0), (2,2), (4,0), (4,2),  ecis-618
          (4,4), (6,0) .... and so on. there are limited to (8,8).      ecis-619
       the radial dependence of potentials is:                          ecis-620
          r = r0*(1 + beta(*,1)*(cos(beta(*,2))*y(2,0)+sin(beta(*,2))*  ecis-621
          (y(2,2)+y(2,-2))*sqrt(0.5)) + beta(*,3)*(cos(beta(*,4))*y(4,0)ecis-622
          +sin(beta(*,4)*(cos(beta(*,5))*(y(4,2)+y(4,-2))*sqrt(0.5))    ecis-623
          +sin(beta(*,5))*(y(4,4)+y(4,-4))*sqrt(0.5)) + ..............  ecis-624
   the 'gamma' type betas as beta(*,i) for i=2,4,5,7... are in degrees. ecis-625
   ******************************************************************** ecis-626
for the constrained asymmetric rotational model, when lo(2)=.true., the ecis-627
       band mixing coefficients are calculated from 'gamma'=beta(*,2)   ecis-628
       in the davydov-filippov model. the sequence of states must be    ecis-629
       the ground state, the first 2+, the second 2+,the other states   ecis-630
       described as in the general case (there can be only the ground   ecis-631
       state and the first 2+). the mixing parameter of the first 2+    ecis-632
       state is used as 'gamma' value instead of beta(1,2), but the     ecis-633
       differences between beta(i,3) are kept. the mixing parameter     ecis-634
       of the second 2+ state is ignored. in a search, the index 4001   ecis-635
       should be used instead of 2002 or 3011 for 'gamma'.              ecis-636
                                                                        ecis-637
deformations of anharmonic vibrational model                            ecis-638
********************************************                            ecis-639
  note:  in this model, there is an unique ratio 1/sqrt(4*pi) for any   ecis-640
  ****  order of deformation. to be consistent with the harmonic        ecis-641
        vibrational model, the deformations indicated below should be   ecis-642
        beta, beta**2/sqrt(4*pi) and beta**3/(4*pi) respectively.       ecis-643
                                                                        ecis-644
deformations                            format (7f10.5)                 ecis-645
************                                                            ecis-646
 only if lo(1)=.false. and .lo(3)=.true., lo(5) or lo(16)=.true.,       ecis-647
 otherwise go to 'optical model parameters'.                            ecis-648
       1-10   beta(1,*) for central potential.                          ecis-649
      11-20   beta(2,*) for volume imaginary potential.                 ecis-650
      21-30   beta(3,*) for surface real potential.                     ecis-651
      31-40   beta(4,*) for surface imaginary potential.                ecis-652
      41-50   beta(5,*) for real spin-orbit.                            ecis-653
      51-60   beta(6,*) for imaginary spin-orbit.                       ecis-654
      61-70   beta(7,*) for coulomb potential.                          ecis-655
                                                                        ecis-656
  next card:                            format (7f10.5)                 ecis-657
  **********                                                            ecis-658
       1-10   beta(8,*) for coulomb spin-orbit potential.               ecis-659
there are four sets of such cards, one for each order of deformation.   ecis-660
                                                                        ecis-661

angular momenta                         format (14i5)                   ecis-662
***************                                                         ecis-663
 only if lo(16)=.true., otherwise go to 'deformations'.(if lo(6)=.true.,ecis-664
heavy-ion definition do not change non coulomb deformation lengths).    ecis-665
        1- 5  for zeroth order (default 2). (not used)                  ecis-666
        6-10  for first order (default 2).                              ecis-667
       11-15  for second order (default 2).                             ecis-668
       16-20  for third order (default 2).                              ecis-669
       21-25  ik   level of which the masses are used for heavy-ion     ecis-670
              corrections. (default option ik=1).                       ecis-671
         enter a negative value if you want 0.                          ecis-672
                                                                        ecis-673
optical potential parameters                                            ecis-674
****************************                                            ecis-675
npp loops to 'equidistant angles' if lo(7)=.false. and lo(10)=.false.   ecis-676
  if lo(7)=.true. and lo(10)=.true. go to 'dispersion parameters' in    ecis-677
  this loop, if lo(7)=.true. and lo(10)=.false. skip them.              ecis-678
                                                                        ecis-679
the program searches to which nuclear level the potential belongs. if   ecis-680
  none is found, a warning is printed and the first one is chosen.      ecis-681
                                                                        ecis-682
volume or scalar real potential         format (3f10.5)                 ecis-683
*******************************                                         ecis-684
       1-10   val(1)   depth in mev.                                    ecis-685
      11-20   val(2)   reduced radius in fermis.                        ecis-686
      21-30   val(3)   diffuseness in fermis.                           ecis-687
                                                                        ecis-688
volume or scalar imaginary potential    format (3f10.5)                 ecis-689
************************************                                    ecis-690
       1-10   val(4)   depth in mev.                                    ecis-691
      11-20   val(5)   reduced radius in fermis.                        ecis-692
      21-30   val(6)   diffuseness in fermis.                           ecis-693
                                                                        ecis-694
surface or vector real potential        format (3f10.5)                 ecis-695
********************************                                        ecis-696
       1-10   val(7)   depth in mev.                                    ecis-697
      11-20   val(8)   reduced radius in fermis.                        ecis-698
      21-30   val(9)   diffuseness in fermis.                           ecis-699
                                                                        ecis-700
surface or vector imaginary potential   format (3f10.5)                 ecis-701
*************************************                                   ecis-702
       1-10   val(10)  depth in mev.                                    ecis-703
      11-20   val(11)  reduced radius in fermis.                        ecis-704
      21-30   val(12)  diffuseness in fermis.                           ecis-705
                                                                        ecis-706
spin-orbit or tensor real potential     format (3f10.5)                 ecis-707
***********************************                                     ecis-708
       1-10   val(13)  depth in mev.                                    ecis-709
      11-20   val(14)  reduced radius in fermis.                        ecis-710
      21-30   val(15)  diffuseness in fermis.                           ecis-711
                                                                        ecis-712
spin-orbit/tensor imaginary potential   format (3f10.5)                 ecis-713
*************************************                                   ecis-714
       1-10   val(16)  depth in mev.                                    ecis-715
      11-20   val(17)  reduced radius in fermis.                        ecis-716
      21-30   val(18)  diffuseness in fermis.                           ecis-717
  note:  the spin-orbit operator is always 2*(l.s)                      ecis-718
  ****  for spin 1/2 particle, the depth is the usual value.            ecis-719
        for spin 1 particle, the depth is the half of the usual value.  ecis-720
                                                                        ecis-721

coulomb potential                       format (3f10.5)                 ecis-722
*****************                                                       ecis-723
       1-10   val(20)  reduced coulomb radius in fermis.                ecis-724
      11-20   val(21)  diffuseness of a woods-saxon charge distribution.ecis-725
      21-30   val(25)  third parameter of a fermi charge distribution.  ecis-726
                                                                        ecis-727
spin-orbit coulomb potential            format (3f10.5)                 ecis-728
****************************                                            ecis-729
       1-10   val(22)  anomalous magnetic moment (less half charge in   ecis-730
              dirac formalism) multiplied by the charge of the target.  ecis-731
      11-20   val(23)  reduced radius in fermis.                        ecis-732
      21-30   val(24)  diffuseness in fermis.                           ecis-733
  note:  if val(21)=0. or val(24)=0. a homogeneous charge distribution  ecis-734
  ****  is used. the product of charges is copied into val(19).         ecis-735
         when the diffuseness of the charge is not zero, the woods-saxonecis-736
        form factor is multiplied by 1+val(25)*r**2. the same parameter ecis-737
        val(25) is used for these two last potentials, if their         ecis-738
        diffuseness is not zero.                                        ecis-739
         if lo(9)=.true., enter a negative radius to use a symmetric    ecis-740
        woods-saxon form factor.                                        ecis-741
         if a diffuseness or the radius of a coulomb potential without  ecis-742
        diffuseness is negative, its absolute value is taken into       ecis-743
        account in subroutine rotp and a message printed.               ecis-744
                                                                        ecis-745
*** end of do-loop for potentials without folding and dispersion ***    ecis-746
*** relations (lo(10)=.false. and lo(17)=.false.) ***                   ecis-747
                                                                        ecis-748
folding for real potentials             format (3f10.5)                 ecis-749
***************************                                             ecis-750
 only if lo(17)=.true., otherwise go to 'dispersion parameters'.        ecis-751
       1-10   val(26) 'v' parameter                                     ecis-752
      11-20   val(27) 'r' parameter                                     ecis-753
      21-30   val(28) 'a' parameter                                     ecis-754
                                                                        ecis-755
folding for imaginary potentials        format (3f10.5)                 ecis-756
********************************                                        ecis-757
       1-10   val(29) 'v' parameter.                                    ecis-758
      11-20   val(30) 'r' parameter.                                    ecis-759
      21-30   val(31) 'a' parameter.                                    ecis-760
                                                                        ecis-761
folding for coulomb potentials          format (3f10.5)                 ecis-762
******************************                                          ecis-763
       1-10   val(32) 'v' parameter.                                    ecis-764
      11-20   val(33) 'r' parameter.                                    ecis-765
      21-30   val(34) 'a' parameter.                                    ecis-766
                                                                        ecis-767
explanation of folding parameters:  the folding functions are normalisedecis-768
**********************************  to 1.  to fold an optical potential,ecis-769
    enter the true charge, the depth of central potential equal to the  ecis-770
    depth of the nucleon potential multiplied by the number of nucleons ecis-771
    in the projectile, and the depth of of spin-orbit potential equal toecis-772
    the depth of the nucleon spin-orbit potential divided by the number ecis-773
    of nucleons in the projectile.                                      ecis-774
      'v'=0    no folding.                                              ecis-775
      'a'=0    gaussian form factor with the range 'r'.                 ecis-776
      'r'=0    hulthen form factor (exp(-r/'v')-exp(-r/'a'))/r.         ecis-777
               reduced to yukawa form factor exp(-r/'v')/r if 'a'=0.    ecis-778
      otherwise  saxon form factor 1/(1+exp((r-'r')/'a').               ecis-779
      if a folding parameter is negative, the absolute value is taken   ecis-780
    into account in subroutine fold and a message printed.              ecis-781
      all the derivatives of potentials needed are obtained by numericalecis-782
    derivation after folding.                                           ecis-783
                                                                        ecis-784

dispersion parameters                   format (2i5,6f10.5)             ecis-785
*********************                                                   ecis-786
 only if lo(10)=.true., otherwise go to 'end of do-loop for potentials'.ecis-787
    1- 5   ipp(1,1)  1 energies in laboratory system, anything for      ecis-788
                     center of mass energy.                             ecis-789
    6-10   ipp(2,1)  n2 power in large negative energy correction term. ecis-790
                     must be even and positive. if 0, term not used.    ecis-791
   11-20   pip(3)    energy for which the imaginary depths are read.    ecis-792
                     (default option: energy of the first level using   ecis-793
                     this potential).                                   ecis-794
   21-30   pip(4)    ef fermi energy. (default option -6.8 mev).        ecis-795
   31-40   pip(5)    ep threshold energy. (default option fermi energy).ecis-796
   41-50   pip(6)    ea large energy starting value above fermi energy. ecis-797
                     (default option 60 mev).                           ecis-798
   51-60   pip(7)    avso exponential decrease of real spin-orbit.      ecis-799
   61-70   pip(8)    awso linear decrease of imaginary spin-orbit.      ecis-800
                                                                        ecis-801
next card                               format (2i5,6f10.5)             ecis-802
*********                                                               ecis-803
    1- 5   ipp(1,2)  nv with |nv| power for volume or scalar potential. ecis-804
    6-10   ipp(2,2)  ns with |ns| power for surface or vector potential.ecis-805
   11-20   pip(9)    bv constant for volume or scalar potential.        ecis-806
   21-30   pip(10)   alp coefficient of large positive energy term in   ecis-807
                     volume potential. (default option 1.65).           ecis-808
                     second bv' parameter for volume potentials if nv<0 ecis-809
                     (default option 2*bv).                             ecis-810
   31-40   pip(11)   cv exponential decrease in sqrt|e| for large       ecis-811
                     energy terms of volume potentials or               ecis-812
                     fv fraction of the first term if nv<0.             ecis-813
   41-50   pip(12)   bs constant for surface or vector potential.       ecis-814
   51-60   pip(13)   cs exponential decrease of a surface potential.    ecis-815
                     (default option 0.0036). if ns is negative         ecis-816
                     bs' second constant for surface or vector          ecis-817
                     potential for ns<0 (default option 2*bw).          ecis-818
   61-70   pip(14)   cr non-locality range parameter of surface         ecis-819
                     potential or fraction in the first term if ns<0.   ecis-820
                                                                        ecis-821
next card                               format (7f10.5)                 ecis-822
*********                                                               ecis-823
    1-10   pip(15)   ahf exponential decrease of h.f. real volume       ecis-824
                     potential which needs the same geometry for real   ecis-825
                     and imaginary volume potential.                    ecis-826
                                                                        ecis-827
explanation of dispersion parameters:                                   ecis-828
*************************************                                   ecis-829
for positive values of nv: the volume imaginary potential at the energy ecis-830
************************** e is assumed to be such that 'v(2*ef-e)=v(e)'ecis-831
    with 'v(e)=v*(e-ef)**nv/((e-ef)**nv+bv**nv)' with addition for      ecis-832
    e>ef+ea of 'alp*[sqrt(e)+.5*(ef+ea)**(3/2)/e-1.5*sqrt(ef+ea)]' and  ecis-833
    for e<ef-ea of '-v(e)*(ef-e-ea)**n2/((ef-e-ea)**n2+ea**n2)' where   ecis-834
    v(e) was given above; these expression can be damped by a factor    ecis-835
    'exp[-cv*sqrt(e-ef-ea)]' and 'exp[-cv*sqrt(ef-ea-e)]' respectively. ecis-836
    the value of 'v' is such that this gives the strength read at the   ecis-837
    energy pip(3). the real volume potential with the same geometry,    ecis-838
    obtained by dispersion relation (as described by c. mahaux and      ecis-839
    r. sartor in nucl. phys a528 (1991) 253), is added to the real      ecis-840
    potential.                                                          ecis-841
for positive values of ns: the surface imaginary potential 'w(e)' in theecis-842
************************** schroedinger formalism is assumed to have theecis-843
    same energy dependence as 'v(e)' given above multiplied by          ecis-844
    'exp[-cs*|e-ef|-cr*(e-ef)]'. the non-locality range parameter 'cr'  ecis-845
    is the inverse of 'eb' given by equations (3.17) and (3.18) of      ecis-846
    c. mahaux and r. sartor in nucl. phys a458 (1986) 25. the real      ecis-847

    surface potential with the same geometry, obtained by dispersion    ecis-848
    relation is added to the real potential. there is not the default   ecis-849
    option cr=.0125 to allow to use 0.                                  ecis-850
for negative values of nv: the volume imaginary potential is assumed to ecis-851
************************** be the sum of two terms similar to 'v(e)'    ecis-852
    used for positive values, with the power |nv| and the parameters bv ecis-853
    and bv' respectively. the strengths are such that the first term is ecis-854
    fv times the value read at the energy pip(3).                       ecis-855
for negative values of ns: the surface imaginary potential is the       ecis-856
************************** difference of two terms similar to those usedecis-857
    for positive values of nv, with the power |ns|, the parameters bs,  ecis-858
    bs' respectively and the same strength.                             ecis-859
      the vector dispersive potential of the dirac formalism is treated ecis-860
    as the scalar one without large energy terms.                       ecis-861
      the powers nv, ns and n2 must be even. input of 0 suppresses the  ecis-862
    use of dispersion relation for the corresponding potential.         ecis-863
                                                                        ecis-864
      ******  end of do-loop for potentials ******                      ecis-865
                                                                        ecis-866
equidistant angles                      format (7f10.5)                 ecis-867
******************                                                      ecis-868
 only if lo(66)=.false., otherwise go to 'spin-orbit parametrisation'.  ecis-869
       1-10   theta1   first angle.                                     ecis-870
      11-20   dtheta   step. (default option 1.)                        ecis-871
      21-30   theta2   last angle.                                      ecis-872
      31-40   dthe     averaging angle. values listed are 1/3 of the sumecis-873
                       of values at theta and theta+/-dthe.             ecis-874
                                                                        ecis-875
spin-orbit parametrisation              format (7f10.5)                 ecis-876
**************************                                              ecis-877
 only if lo(4)=.true., otherwise go to 'hauser-feshbach corrections'.   ecis-878
       1-10   az1.                                                      ecis-879
      11-20   az2.        (these parameters are in an array             ecis-880
      21-30   az3.                                                      ecis-881
      31-40   az4.        az(16) from az(1) to az(6) for the search)    ecis-882
      41-50   az5.                                                      ecis-883
      51-60   az6.                                                      ecis-884
  note: the unparametrised spin-orbit deformation is:                   ecis-885
  ****   az1=az4=0.,  az2=az3=az5=az6=1.                                ecis-886
        the spin-orbit deformation multiplied by x is:                  ecis-887
          az1=az4=0., az2=1., az3=az5=az6=x .                           ecis-888
        the 'incorrect' spin-orbit deformation is:                      ecis-889
          az1=az2=az5=az6=0., az3=az4=0.5 .                             ecis-890
        for the most general parametrisation of deformed spin-orbit see ecis-891
       comment cards in subroutine quan.                                ecis-892
                                                                        ecis-893
hauser-feshbach corrections             format (7f10.5)                 ecis-894
***************************                                             ecis-895
 only if lo(81)=.true., otherwise go to 'cards read in subroutine deph'.ecis-896
      1-10   bz1.   square root of elastic enhancement.                 ecis-897
                    (default option 1.4142).                            ecis-898
     11-20   bz2.   if lo(82)=.true., spin cut-off parameter (default   ecis-899
                    option 3.5). if lo(82)=.false., particle degrees of ecis-900
                    freedom.                                            ecis-901
     21-30   bz3.   square root of level density parameter.             ecis-902
                    (default option 100.). if lo(82)=lo(87)=.false.,    ecis-903
                    parameter bz3 in moldauer's formula given below.    ecis-904
                    (default option 1.212).                             ecis-905

     31-40   bz4.   if lo(82)=lo(87)=.false., parameter bz4 in mol-     ecis-906
                    dauer's formula given below. (default option 0.78). ecis-907
     41-50   bz5.   if lo(82)=lo(87)=.false., parameter bz5 in mol-     ecis-908
                    dauer's formula given below. (default option 0.228).ecis-909
  note:  the penetrabilities, which are probabilities of compound       ecis-910
  ****  nucleus formation, are related to partial cross-sections minus  ecis-911
        the reaction cross-section to the channels taken into account.  ecis-912
         if lo(82)=.true., denoting by ti and tf the penetrabilities    ecis-913
        defined above for the incoming and the outgoing channels, the   ecis-914
        hauser-feshbach correction is: ti*tf/(4*(sum on all the t)+     ecis-915
        +bz3**2*(2*j+1)*exp(-(j*j+j)/(2*bz2**2)) for inelastic channels,ecis-916
        multiplied by bz1**2 for the elastic one.                       ecis-917
        for the search, these quantities are in az from az(7) to az(9). ecis-918
         for lo(82)=.false.: without fluctuations (lo(87)=.true.), bz1  ecis-919
        is used and can be in search; with fluctuations (lo(87)=.false.)ecis-920
        the given value of bz2 is used if bz2 is not 0; if bz2=0., the  ecis-921
        channel degree of freedom parameter, formula (1) in p.a.        ecis-922
        moldauer, nuclear physics a344 (1980), page 185-195, which is:  ecis-923
            1.78d0+(tl**1.212d0-0.78d0)*dexp(-0.228d0*sum on tl)        ecis-924
        is generalised by the expression:                               ecis-925
            1.d0+bz4+(tl**bz3-bz4)*dexp(-bz5*sum on tl)                 ecis-926
        if lo(82)=.true. bz1 and bz2 can be in search; if lo(82)=.false.ecis-927
        and lo(87)=.true. bz3 can be in search; if lo(82)=lo(87)=.false.ecis-928
        bz2 can be in search, but if bz2=0., bz3, bz4 and bz5 can also  ecis-929
        be in search.                                                   ecis-930
                                                                        ecis-931
fission data                            format (7f10.5)                 ecis-932
************                                                            ecis-933
if lo(82)=.true., go to 'cards read in subroutine deph'.                ecis-934
if lo(85)=.false., go to 'giant dipole resonance description'.          ecis-935
      1-10   fiss(1,*)  transmission coefficient                        ecis-936
     11-20   fiss(2,*)  degrees of freedom. if <.5, it is replaced by 0.ecis-937
  there are nfiss such cards. the first coefficient is for the smallest ecis-938
total j value of the system and the same parity of the ground state. theecis-939
second one is for the opposite parity. the following ones are for higherecis-940
j values, with the same order for parities.                             ecis-941
                                                                        ecis-942
giant dipole resonance description      format (7f10.5)                 ecis-943
**********************************                                      ecis-944
  only if lo(86)=.true., otherwise go to 'level density for continuum'. ecis-945
   if nrd is not 0, go to 'gamma transmission factors'.                 ecis-946
       data to compute the (neutron, gamma) cross-section when the giantecis-947
   dipole resonance model is used (see e. lynn, 'the theory of neutron  ecis-948
   resonance reactions', pages 321/326 and a. gilbert and a.g.w.        ecis-949
   cameron, can. jour. of physics 43, 1446, 1965, pages 1475/1476).     ecis-950
      1-10   tgo   slow s-wave neutron gamma widths/spacing for         ecis-951
                   normalisation. if tgo=0, lo(86) is set .false.       ecis-952
     11-20   bn    neutron separation energy.(default option 8.).       ecis-953
     21-30   fnug  radiative degrees of freedom.                        ecis-954
                   if less than 1., it is replaced by fnug=20.          ecis-955
     31-40   egd   energy of the giant dipole resonance.                ecis-956
                   (default option 163*(n*z)**2/(n+z)**(4/3).).         ecis-957
                   the strong absorption model id used if egd < 0.      ecis-958
                   (simple behaviour as e**3 instead of resonance       ecis-959
                   with a factor e**4)                                  ecis-960
     41-50   ggd   resonance width. (default option 5.).                ecis-961
    for the search, these quantities are in az from az(12) to az(16).   ecis-962
                                                                        ecis-963

gamma transmission factors              format (7f10.5)                 ecis-964
**************************                                              ecis-965
 only if lo(86)=.true. and nrd is not 0.                                ecis-966
      1-10   gam(1) for l=0.                                            ecis-967
     11-20   gam(2) for l=1.                                            ecis-968
     .......................                                            ecis-969
     61-70   gam(7) for l=6.                                            ecis-970
  up to gam(nrd), eventually on others cards.                           ecis-971
                                                                        ecis-972
level density of compound nucleus       format (7f10.5)                 ecis-973
*********************************                                       ecis-974
   if there are gamma transmission parameters computed with the giant   ecis-975
dipole resonance model (lo(86)=.true. and nrd=0 in 'compound nucleus    ecis-976
data'),  or continua (ncont not 0 in 'compound nucleus data'), otherwiseecis-977
go to 'cards read in subroutine deph'.                                  ecis-978
   for the total residual nucleus needed for the gamma giant resonance, ecis-979
followed by the residual nucleus of each continuum:                     ecis-980
      1-10   scn(7,i) z:   charge of the compound nucleus               ecis-981
     11-20   scn(1,i) sa:  level density parameter for s-wave resonance ecis-982
                           spacing. (default option (.0091*(shell corr. ecis-983
                           -.23*nd)+.143)*na where na is the total      ecis-984
                           number of nucleons, nd the minimum distance  ecis-985
                           to a magic number for protons or neutrons andecis-986
                           shell corrections are given by cook: see     ecis-987
                           tables and references in subroutine lden).   ecis-988
     21-30   scn(2,i) ux:  matching energy for the two density formula  ecis-989
                           shifted by pairing energy. (default value    ecis-990
                           2.5+150/na).                                 ecis-991
     31-40   scn(3,i) tau: nuclear temperature. (default option         ecis-992
                           1/tau=sqrt(sa/ux)-1.5/ux).                   ecis-993
     41-50   scn(4,i) sg:  spin cut off parameter. (default option      ecis-994
                           formula (11) of gilbert and cameron).        ecis-995
     51-60   scn(5,i) e0:  energy shift. (default option formula (28) ofecis-996
                           gilbert and cameron).                        ecis-997
     61-70   scn(6,i) ex:  matching energy between the two density      ecis-998
                           formulae. (default option ux+pairing with    ecis-999
                           pairing given by cook)                       ecis1000
  note:  the dimensions of the array scn are 7 and ncons. scn(j,i)      ecis1001
  ****  can be searched for j=1 to 6. if scn(j,i) is 0., it is replaced ecis1002
        by the default option computed with the scn(j,k) for k<i. if    ecis1003
        scn(3,i) is negative, it is replaced by the default option      ecis1004
        computed with default options for sa and ux. after replacement, ecis1005
        density parameters used, which must be taken into account for a ecis1006
        search or a change using lo(37)=.true. are listed at the end.   ecis1007
                                                                        ecis1008
                                                                        ecis1009
cards read in subroutine deph                                           ecis1010
*****************************                                           ecis1011
                                                                        ecis1012
number of observables by channel        format (14i5)                   ecis1013
********************************                                        ecis1014
    (non-standard observables) only if lo(94)=.true. and lo(66)=.false.,ecis1015
    otherwise go to 'restricted coulomb corrections'.                   ecis1016
       1- 5   number of observables for the elastic scattering.         ecis1017
       6-10   number of observables for the first excited state.        ecis1018
      11-15   number of observables for the second excited state.       ecis1019
      16-20   number of observables for the third excited state.        ecis1020
      21-25   ...........                                               ecis1021
              up to the last coupled channel (ncoll values).            ecis1022
                                                                        ecis1023

for each coupled state                                                  ecis1024
**********************                                                  ecis1025
                                                                        ecis1026
observable identifications              format (14i5)                   ecis1027
**************************                                              ecis1028
       1- 5   first observable which must be the cross-section (enter a ecis1029
              blank or 0) .                                             ecis1030
       6-10   second observable.                                        ecis1031
      11-15   third observable.                                         ecis1032
      16-20   fourth observable.                                        ecis1033
      21-25   fifth observable.                                         ecis1034
      26-30   ...........                                               ecis1035
              up to the last observable.                                ecis1036
                                                                        ecis1037
   standard description  0   cross-section.                             ecis1038
   ********************  1   cross-section / rutherford's cross-section.ecis1039
                         2   vector analysing power.                    ecis1040
      3     vector polarisation.                                        ecis1041
            (note a ratio sqrt(2.) with it11 for spin 1/2 for 2 and 3). ecis1042
      4     t20 .                                                       ecis1043
      5     t21 .                                                       ecis1044
      6     t22 .                                                       ecis1045
      7     kyy or d  defined as -a(1100 1100)-a(1100 1-100)            ecis1046
      8     kxx or r  defined as  a(1100 1100)-a(1100 1-100)            ecis1047
      9     kzz or a' defined as  a(1000 1000)                          ecis1048
     10     kxz or r' defined as -sqrt(2.) a(1100 1000)                 ecis1049
     11     kzx or a  defined as -sqrt(2.) a(1000 1100)                 ecis1050
     12     spin-flip :  (a(0000,0000)+a(1100,1100)+a(1100,1-100))/2    ecis1051
     13     vector analysing power of the target                        ecis1052
          (note a ratio sqrt(2.) with it11 for spin 1/2 for 2, 3 and 13)ecis1053
     14     ayy  defined as -a(1111 0000)-a(111-1 0000)                 ecis1054
     15     axx  defined as  a(1111 0000)-a(111-1 0000)                 ecis1055
     16     azz  defined as  a(1010 0000)                               ecis1056
     17     axz  defined as -sqrt(2.) a(1110 0000)                      ecis1057
     18     azx  defined as -sqrt(2.) a(1011 0000)                      ecis1058
     19     reserved for a set of experimental data which are reaction  ecis1059
                 cross-sections. see 'cards read in subroutine lecd'    ecis1060
            note that 12 and 19 were previously 7 and 8.                ecis1061
                                                                        ecis1062
    non standard description    enter a negative value, different for   ecis1063
    ************************    different observables. the description  ecis1064
                                will be read in subroutine obse.        ecis1065
          cross-sections must be before polarisations.                  ecis1066
                                                                        ecis1067
plot indications                        format (14i5)                   ecis1068
****************                                                        ecis1069
       1- 5   number of decades in logarithmic scales for cross-section.ecis1070
       6-10   indication for second observable.                         ecis1071
      11-15   indication for third observable.                          ecis1072
      16-20   ...................                                       ecis1073
              up to the last observable.                                ecis1074
      indications for polarisations are '1' for plot and '0' for no plotecis1075
                                                                        ecis1076
      ******  end of do-loop for nuclear states ******                  ecis1077
                                                                        ecis1078
restricted coulomb corrections          format (14i5)                   ecis1079
******************************                                          ecis1080
    if lo(44) and lo(46)=.true., otherwise go to 'cards read in         ecis1081
  subroutine calx'.  for each nuclear level:                            ecis1082

          1- 5   niv(i,j,3) between level i and level j for j=1.        ecis1083
          6-10   niv(i,j,3) between level i and level j for j=2.        ecis1084
         11-15   .........................                              ecis1085
                 enter '1' for coulomb correction and '0' for none.     ecis1086
    only values for j smaller than or equal to i are taken into account.ecis1087
         there are ncoll such cards.                                    ecis1088
                                                                        ecis1089
                                                                        ecis1090
cards read in subroutine calx                                           ecis1091
*****************************                                           ecis1092
 only if lo(31)=.true., otherwise go to 'cards read in subroutine obse'.ecis1093
                                                                        ecis1094
chi2 conditions                         format (4i5,2f10.5)             ecis1095
***************                                                         ecis1096
       1- 5   ncolr  number of angular distributions. if some of them   ecis1097
                     are sums on several levels, they account for their ecis1098
                     number of levels in ncolr.                         ecis1099
       6-10   nrec   number of parameters in search.                    ecis1100
      11-15   nfit   number of functions kept in the search beyond the  ecis1101
                     minimum number which is nrec+1 .                   ecis1102
      16-20   nessai maximum number of evaluations. (default option 100)ecis1103
                     this value is not used when lo(34)=.true..         ecis1104
      21-30   ech    search scale. (default option 20.).                ecis1105
                     in the preliminary runs, variables are changed by  ecis1106
                     the product of this number with their accuracy. in ecis1107
                     the others runs, the change of any variable is     ecis1108
                     limited by twice this value.                       ecis1109
      31-40   rap    ratio of increase for the search scale after a run ecis1110
                     for which the chi2 decreased. (default option 1.)  ecis1111
                     the value of ech is the product by rap of the last ecis1112
                     maximum change of parameter which gave a lower chi2ecis1113
                     the value 1 leads safely to the minimum. a value   ecis1114
                     larger than 1. leads quicker towards the minimum.  ecis1115
                     a value less than 1. is replaced by 1.             ecis1116
                                                                        ecis1117
                                                                        ecis1118
cards read in subroutine lecd                                           ecis1119
*****************************                                           ecis1120
 only if ncolr is not 0, otherwise go to 'cards read in subroutine obse'ecis1121
the angular distributions can be read in any order.                     ecis1122
                                                                        ecis1123
for each angular distribution                                           ecis1124
*****************************                                           ecis1125
                                                                        ecis1126
identification                          format (l1,i1,i3,2i5,5x,3f10.5) ecis1127
**************                                                          ecis1128
          1   lx logical. if lx=.true. the experimental errors are      ecis1129
              percentages. lx is set .false. if the observable          ecis1130
              identification is not 0, 1 or 19.                         ecis1131
          2   1 if the angles are in the laboratory system, 0 otherwise.ecis1132
       3- 5   nt   number of angles.                                    ecis1133
       6-10   number of the nuclear state.                              ecis1134
      11-15   observable identification. (see comments on 'observable   ecis1135
              identification' in 'cards read in subroutine deph').      ecis1136
      21-30   weight of this observable in chi2. (default option 1.)    ecis1137
      31-40   experimental normalisation of data. (default option 1.)   ecis1138
      41-50   error on experimental normalisation. (if 0., the          ecis1139
              normalisation is fixed).                                  ecis1140

                the experimental values and their errors are divided by ecis1141
              the 'renormalisation parameter'. if the normalisation is  ecis1142
              fixed, this parameter is the 'experimental normalisation'.ecis1143
              if the normalisation is not fixed, the square of the      ecis1144
              difference between the 'experimental normalisation' and   ecis1145
              this parameter divided by the 'error on experimental      ecis1146
              normalisation' is added to the chi2 for this observable   ecis1147
              following the definition of the chi2. the 'calculated     ecis1148
              normalisation' is the value of the 'renormalisation       ecis1149
              parameter' which minimises the chi2. experimental values  ecis1150
              and errors are divided by it.                             ecis1151
                if for two successive angular distributions, both       ecis1152
              cross-sections or polarisations, the 'errors on           ecis1153
              experimental normalisations' are non-0 and the same and   ecis1154
              the two 'experimental normalisation' are identical, the   ecis1155
              renormalisation parameters are the same for these two     ecis1156
              angular distributions and one value is added to the chi2  ecis1157
              for each one.                                             ecis1158
  note:  if nt=0, the angular distribution described here is not        ecis1159
  ****  experimentally separated from the following one. it cannot      ecis1160
        happen for the last angular distribution and the observables    ecis1161
        must be of the same kind (if not, the program stops).           ecis1162
        angular distribution is attributed to the level read without    ecis1163
        nt=0 which can be any of them.                                  ecis1164
            the program stops also if the channel number is too large   ecis1165
        or if the observable identification is larger than 19.          ecis1166
                                                                        ecis1167
data card for each angle                format (6f10.5)                 ecis1168
************************                                                ecis1169
       1-10   angle in degrees.                                         ecis1170
      11-20   experimental value.                                       ecis1171
      21-30   experimental error.                                       ecis1172
      31-40   width of detector. (if non 0.,three calculations are done ecis1173
              at the experimental angle and at plus and minus this      ecis1174
              width, the calculated value will be the mean value).      ecis1175
      41-50   angular error. (if non 0. and the width of detector non 0.ecis1176
              the experimental error is increased to take into account  ecis1177
              the slope of the calculated curve).                       ecis1178
  note:  if the observable identification is 19, the set of experimentalecis1179
  ****  values are total cross-sections of which the channel is read in ecis1180
        floating value instead of the angle. for channel 0., it is the  ecis1181
        total reaction cross-section, not taking into account the       ecis1182
        coulomb scattering. for channel -1., it is the total            ecis1183
        cross-section as defined for neutrons. weight and experimental  ecis1184
        normalisation are taken into account. for compound nucleus,     ecis1185
        uncoupled levels, continua, fission and gamma cross-sections    ecis1186
        follow the coupled states.                                      ecis1187
                                                                        ecis1188
                                                                        ecis1189
cards read in subroutine calx                                           ecis1190
*****************************                                           ecis1191
 only if lo(31)=.true., otherwise go to 'cards read in subroutine obse'.ecis1192
                                                                        ecis1193
search accuracies                       format (7f10.3)                 ecis1194
*****************                                                       ecis1195
 only if lo(32)=.true. and neither ncolr and nrec is 0, otherwise go to ecis1196
 'cards read in subroutine obse'.                                       ecis1197

       1-10   search accuracy for the first variable.                   ecis1198
      11-20   search accuracy for the second variable.                  ecis1199
      21-30   search accuracy for the third variable.                   ecis1200
      31-40   ....................                                      ecis1201
              up to nrec values.                                        ecis1202
      the search accuracies cannot be 0..there is no default option.    ecis1203
  they refer to values used in the program as real radii or             ecis1204
  deformations changed for heavy ions.                                  ecis1205
                                                                        ecis1206
indices of variables                    format (14i5)                   ecis1207
********************                                                    ecis1208
       1- 5   index of the first variable.                              ecis1209
       6-10   index of the second variable.                             ecis1210
      11-15   index of the third variable.                              ecis1211
      16-20   ....................                                      ecis1212
              up to nrec values.                                        ecis1213
                                                                        ecis1214
    index specifications:                                               ecis1215
    *********************                                               ecis1216
       1-1000   optical model and folding parameters val(i).(see, above,ecis1217
                optical potential parameters). possible values 1 to     ecis1218
                34*npp. parameters of external form factors in the orderecis1219
                defined when they are read. only floating values can be ecis1220
                in search possible values 1 to 1000. above, add 9000.   ecis1221
                choosing search accuracies, note that reduced radii are ecis1222
                not used but only radii.                                ecis1223
    1001-2000   deformations for a given potential. possible values 1001ecis1224
                to 1008.(not the angles of asymmetric rotational model) ecis1225
    2001-3000   deformations for a given multipole. possible values 2001ecis1226
                to 2000+nbet where nbet is the total number of phonons  ecis1227
                and deformations as listed in the output.               ecis1228
    3001-4000   individual deformation. (the unit of the index is the   ecis1229
                potential, the tenth is the deformation). to simplify   ecis1230
                notations, possible value are 3001 to 3000+10*nbet with ecis1231
                nbet defined above. values 3xx9 and 3xx0 are excluded.  ecis1232
                note that deformation lengths are used in the search if ecis1233
                lo(6)=.true..                                           ecis1234
    4001-5000   nuclear model parameters. (in the order of input).      ecis1235
    5001-6000   reduced nuclear matrix elements. (order of input if theyecis1236
                are read on cards, or order of computation as listed).  ecis1237
    6001-7000   spin-orbit parametrisation, hauser-feshbach corrections.ecis1238
                and compound nucleus parameters. possible values are:   ecis1239
                6001-6006 for spin-orbit parametrisation,               ecis1240
                6007-6011 for hauser-feshbach corrections,              ecis1241
                6012-6016 for giant dipole resonance parameters,        ecis1242
                (in a test, 6015 was useless for lo(87)=.false., 6014   ecis1243
                and 6015 if lo(97=.true.)                               ecis1244
                6017-6016+6*ncons for level density parameters in order ecis1245
                given by scn(6,ncons), skipping the charge. only values ecis1246
                printed as used values can be changed.                  ecis1247
                (in a test, scn(5,i) was useless for gamma, scn(1,i),   ecis1248
                scn(2,i) and scn(6,i) for a continuum)                  ecis1249
                6016+6*ncons-6016+6*ncons+nrd gamma transmission coeff. ecis1250
                6016+6*ncons+nrd-6016+6*ncons+nrd+2*nfiss fission       ecis1251
                transmission coefficients.                              ecis1252
    7001-8000   dispersion parameter from pip(4,*) to pip(15,*) without ecis1253
                possibility to change the description induced by the    ecis1254
                integer values ipp(*,1,*), ipp(*,2,*) an energy         ecis1255
                reference pip(3,*). possible values from 7001 to        ecis1256
                7000+12*npp.                                            ecis1257

   10001-99999  to continue 1-1000 when there are more than 1000 values ecis1258
                with external form factors. use the number of the       ecis1259
                listing increased by 9000.                              ecis1260
  note:  any negative number -k in the card above means that k variablesecis1261
  ****  will be kept proportional in the search. this value is replaced ecis1262
        by -*address where k followed by k indices of parameters is     ecis1263
        stored                                                          ecis1264
                                                                        ecis1265
links between variables                 format (14i5)                   ecis1266
***********************                                                 ecis1267
    for every negative value -k in the preceding card:                  ecis1268
       1- 5   index of the first variable.                              ecis1269
       6-10   index of the second variable.                             ecis1270
      11-15   index of the third variable.                              ecis1271
      16-20   ..................                                        ecis1272
              up to k indices.                                          ecis1273
                                                                        ecis1274
                                                                        ecis1275
cards read in subroutine obse                                           ecis1276
*****************************                                           ecis1277
 only if there is any non standard observable (identified by a negative ecis1278
 number), otherwise go to 'cards read in subroutine redm'.              ecis1279
                                                                        ecis1280
for each non standard observable                                        ecis1281
********************************                                        ecis1282
                                                                        ecis1283
definition and name                     format (2l1,i1,i2,i5,5a4)       ecis1284
*******************                                                     ecis1285
          1   lt1  't' for an observable defined with an axis           ecis1286
                   perpendicular to the reaction plane. the description ecis1287
                   is changed by a rotation r(pi/2,pi/2,pi/2) to the    ecis1288
                   definition with respect to the direction of particle ecis1289
                   (helicity). use a blank for the usual helicity       ecis1290
                   description.                                         ecis1291
          2   lt2  't' if the observable is not completely defined by   ecis1292
                   tensors. see note below 'quantum numbers'.           ecis1293
          3   blank or 0 for observable in the center of mass system.   ecis1294
              1          for observable in the laboratory system.       ecis1295
              2          for observable defined with respect to the     ecis1296
                              incident beam.                            ecis1297
       4- 5   kx   positive number, identification of the observable    ecis1298
                   read with -kx.                                       ecis1299
       6-10   k    number of components of the description.             ecis1300
      11-30   name of the observable which will be used in the output.  ecis1301
                                                                        ecis1302
quantum numbers                         format (8i5)                    ecis1303
***************                                                         ecis1304
       1- 5   tensor order of the incoming particle.                    ecis1305
       6-10   related magnetic quantum number.                          ecis1306
      11-15   tensor order of the initial nucleus.                      ecis1307
      16-20   related magnetic quantum number.                          ecis1308
      21-25   tensor order of the outgoing particle.                    ecis1309
      26-30   related quantum number.                                   ecis1310
      31-35   tensor order of the final nucleus.                        ecis1311
      36-40   related quantum number.                                   ecis1312
    there are k such cards.                                             ecis1313
  note:  if lt2=.true., some couples (tensor order, magnetic quantum    ecis1314
  ****  number) can be replaced by non tensor notation (mi, mf). in thisecis1315
        case, use (mi-s-1) and (mf-s-1) where s is the spin of particle ecis1316
        or target.                                                      ecis1317
                                                                        ecis1318

coefficients of components              format (6f10.5)                 ecis1319
**************************                                              ecis1320
       1-10   coefficient of the first component.                       ecis1321
      11-20   coefficient of the second component.                      ecis1322
      21-30   ...................                                       ecis1323
              up to k values.                                           ecis1324
                                                                        ecis1325
imaginary part of coefficients          format (6f10.5)                 ecis1326
******************************                                          ecis1327
 only if lt1=.true. or lt2=.true., otherwise go to next observable.     ecis1328
       1-10   imaginary part for the first component.                   ecis1329
      11-20   imaginary part for the second component.                  ecis1330
      21-30   ....................                                      ecis1331
              up to k values.                                           ecis1332
  note:  the quantum numbers are checked and errors can stop the        ecis1333
  ****  program (too large magnetic quantum numbers, negative tensor    ecis1334
        order, odd sum of magnetic quantum numbers for observable       ecis1335
        defined with the axis perpendicular to the reaction plane).     ecis1336
         the observables can be read in any order.                      ecis1337
         polarisation of the target is described in the system of the   ecis1338
        particle.                                                       ecis1339
                                                                        ecis1340
                                                                        ecis1341
cards read in subroutine redm                                           ecis1342
******************************                                          ecis1343
      if lo(7)=.true. or lo(15)=.true.. otherwise go to 'cards read in  ecis1344
   subroutine eval'.                                                    ecis1345
                                                                        ecis1346
      in the subroutine redm, there is the following do loop:           ecis1347
          do 16 i1=1,ncoll                                              ecis1348
          do 15 i2=i1,ncoll                                             ecis1349
          .........                                                     ecis1350
       15 continue                                                      ecis1351
       16 continue                                                      ecis1352
      inside which must be read:                                        ecis1353
                                                                        ecis1354
loop control and number card            format (3i5)                    ecis1355
****************************                                            ecis1356
       1- 5   j1 which must be equal to i1. (if not the run is stopped).ecis1357
       6-10   j2 which must be equal to i2. (if not the run is stopped).ecis1358
      11-15   k  number of reduced nuclear matrix elements.             ecis1359
                                                                        ecis1360
reduced nuclear matrix elements         format (4i5,f20.12)             ecis1361
*******************************                                         ecis1362
if k is not 0:                                                          ecis1363
       1- 5   form factor identification.                               ecis1364
       6-10   multipolarity. (if triangular relation  or parity is      ecis1365
                  transgressed the run is stopped). enter l for a       ecis1366
                  magnetic multipole transition bm(l-1).                ecis1367
      11-15   2*s where s is the transfer of spin. s can be not 0 even  ecis1368
                  if lo(7)=.false. (if lo(7)=.true. the run is stopped  ecis1369
                  when triangular relation is not fulfilled).           ecis1370
              indication for existence of magnetic multipole coulomb    ecis1371
                  form factor for the target, with s=0: enter '-1'.     ecis1372
                  this form factor includes no central and no           ecis1373
                  spin-orbit contribution.                              ecis1374
      16-20   2*j where j is the transfer of total spin if the value    ecis1375
                  given for 2*s is not '0' or '-1'. in this case the    ecis1376
                  calculation is stopped if there is not a triangular   ecis1377
                  relation between l, s and j.                          ecis1378

              indication for existence of an associated spin-orbit form ecis1379
                  factor when 2*s is '0': enter '1' if there is one,    ecis1380
                  '0' or a blank if there is none.                      ecis1381
      21-40   value. the ratio between a magnetic multipole coulomb     ecis1382
                  excitation bm(l-1) and an electric one be(l) is       ecis1383
                  sqrt(bm(l-1)/be(l)) (sqrt(.01106*bm(l-1)/be(l)) if    ecis1384
                  bm(l-1) is expressed in nuclear magnetons squares.    ecis1385
        there are k such cards.                                         ecis1386
                                                                        ecis1387
    form factor identification                                          ecis1388
    **************************                                          ecis1389
      for anharmonic vibrational model: the order of derivative.        ecis1390
             (from 0 to 3).                                             ecis1391
      for harmonic vibrational model:                                   ecis1392
             first order:  k1, number of the phonon is order of input.  ecis1393
             second order: k1+k2*(nbt1+1)  where k1 and k2 are the      ecis1394
                 number of the phonons in the order of input, with k2   ecis1395
                 larger than k1 and nbt1 the total number of phonons.   ecis1396
                                                                        ecis1397
      for symmetric rotational model: 1+l where l is the multipolarity  ecis1398
             multiplied by 1000 plus the identification of the          ecis1399
             vibrational band as in harmonic vibrational model.         ecis1400
             a l=0 or l=1 vibration term generate a monopole or dipole  ecis1401
             correction term.                                           ecis1402
      for asymmetric rotational model: defined as 1000* the 'order of   ecis1403
             deformation'. (see 'deformations of rotational models').   ecis1404
                                                                        ecis1405
      for external form factor model: if the form factor identification ecis1406
             is blank or zero, an identification is defined in sequence ecis1407
             a negative value indicates that there is a correction term ecis1408
             to be added in such a way that the integral of the sum withecis1409
             r**(l+2) vanishes (l being the angular momentum related to ecis1410
             this form factor). if the form factor identification is nonecis1411
             zero, its absolute value must be in sequence or refer to a ecis1412
             form factor already defined with the same sign.            ecis1413
                                                                        ecis1414
  note on reduced matrix elements:  the spin angular description for a  ecis1415
  ********************************  partial wave with total spin jj and ecis1416
  with quantum numbers l1 and j1 for the particle, i1 for the target is ecis1417
  ((i**l1*y(l1) , s1)j1 ,i1)jj. the interaction for the transfer of     ecis1418
  angular momentum l, of spin s and of total spin j, is the scalar      ecis1419
  product of a tensor operator q(j)nuclear for the target by the tensor ecis1420
  product of (i**l*y(l) , q(s)par)j for the particle.                   ecis1421
    (((l2,s2)j2,i2)jj|(q(l),q(s))j.q(j)|((l1,s1)j1,i1)jj) =             ecis1422
  (-)**(jj+i2+j1+(l1+l2+l)/2)) * c9j(l2,l1,l,s2,s1,s,j2,j1,j) *         ecis1423
  c6j(j2,j,j1,i1,jj,i2) * c3j(l1,l,l2,0,0,0) * sqrt((2j+1)*(2l+1)*      ecis1424
  (2s+1)(2l1+1)*(2l2+1)*(2j1+1)*(2j2+1)) /computed in subroutine quan/  ecis1425
  * (s2||q(s)||s1)/(2s+1) * (i2||q(j)||i1) * (4*pi)**(-1/2) /which is   ecis1426
  the reduced nuclear matrix element read here, except for the square   ecis1427
  root which is included in form factors/.                              ecis1428
                                                                        ecis1429
    this matrix element is real and symmetric when the 'reduced nuclear ecis1430
  matrix element' is such that  (s2,i2 || q(s) q(j) ||s1,i1) =          ecis1431
  (-)**(i2+s2-i1-s1+s+j) * (s1,i1 || q(s) q(j) ||s2,i2). in macroscopic ecis1432
  models, s=0 and the phase becomes (-)**(i2-i1)*(product of parities). ecis1433
    a factor i**(-l) must be taken into account in the definition of    ecis1434
  q(j)nuclear and a phase i introduced for negative parity states.      ecis1435
    when s=0, (s2|| ||s1) = sqrt(2*s1+1) is computed in subroutine quan ecis1436
    the factor (2s+1) introduced in quan to use the same reduced matrix ecis1437
  element when target and particle are exchanged.                       ecis1438

    for a magnetic multipole coulomb transition bm(l-1), the form factorecis1439
  is the one of an electric multipole transition be(l) divided by       ecis1440
  mr(m*c/hbar)**2, where m and mr and mp are atomic and reduced masses  ecis1441
  respectively.                                                         ecis1442
                                                                        ecis1443
                                                                        ecis1444
cards read in subroutine extp                                           ecis1445
*****************************                                           ecis1446
  if (lo(7)=.true., otherwise go to 'cards read in subroutine eval'.    ecis1447
                                                                        ecis1448
identification                          format (12i5)                   ecis1449
**************                                                          ecis1450
       1- 5   l1    level i.                                            ecis1451
       6-10   l2    level ip.                                           ecis1452
      11-15   ml    sequence number of the form factor in the table of  ecis1453
                    reduced nuclear matrix elements between level i and ecis1454
                    level ip. it must be 0 for potentials. use the      ecis1455
                    value -ml to enter the correction term to the form  ecis1456
                    factor read with ml.                                ecis1457
      16-20   ityp =  1 real volume or scalar potential                 ecis1458
                      2 imaginary volume or scalar potential            ecis1459
                      3 real surface or vector potential                ecis1460
                      4 imaginary surface or vector potential           ecis1461
                      5 real spin-orbit or tensor potential             ecis1462
                      6 imaginary spin-orbit or tensor potential        ecis1463
                      7 coulomb potential                               ecis1464
                      8 coulomb spin-orbit potential                    ecis1465
      21-25   l1x   non positive or l1 of the form factor to be copied  ecis1466
                    into the new one.                                   ecis1467
      26-30   l2x   l2 of the form factor to be copied if l1x is not    ecis1468
                    positive.                                           ecis1469
      31-35   mlx   same for ml if l1x is not positive.                 ecis1470
      36-40   itypx same for ityp if l1x is not positive, must be equal ecis1471
                    to ityp.                                            ecis1472
                    negative number for standard form factors with non  ecis1473
                    positive value of l1x in columns 21-30:             ecis1474
                        -1  woods-saxon potential.                      ecis1475
                        -2  first derivative of woods-saxon potential.  ecis1476
                        -3  second derivative of woods-saxon potential. ecis1477
                        -4  third derivative of woods-saxon potential.  ecis1478
            (the n th derivative is always divided by fact(n)*sqrt(4*pi)ecis1479
                 and multiplied by r**n only if lo(6)=.false.)          ecis1480
                        -5  deformed woods-saxon potential.             ecis1481
                        -6  derivative of deformed woods-saxon potentialecis1482
                        -7  laguerre polynomial.                        ecis1483
                        -8  solution in real woods-saxon potential.     ecis1484
                        -9  bessel expansion.                           ecis1485
                        -10 expansion with laguerre polynomials.        ecis1486
                    (see below 'special meaning of l1x, l2x and mlx ..')ecis1487
      41-45   nst   channel of which the step size is used (default     ecis1488
                    value: the channel which uses it for a central      ecis1489
                    potential, 1 for a transition potential). if nst is ecis1490
                    negative for a standard form factor with itypx=-1 toecis1491
                    itypx=-6, use of a reduced radius, taking into      ecis1492
                    account lo(16) (heavy-ion definition) and lo(6)     ecis1493
                    (use of deformation lengths).                       ecis1494
      46-50   nfold 0 for no folding or address of folding parameters   ecis1495
                    in their list read below. nfold can be different forecis1496

                    a copied form factor and allows the folding with a  ecis1497
                    different multipolarity. it can be used with a      ecis1498
                    form factor given by points.                        ecis1499
      51-55   nint  if not 0, the strength is the integral of this form ecis1500
                    factor with r**(l+2) where l is the relevant angularecis1501
                    momentum. when nint, is a positive number, the      ecis1502
                    integral with r**(l+1) has to be given; with a      ecis1503
                    negative integer, the usual strength has to be givenecis1504
                    and is replaced by this integral at its first       ecis1505
                    calculation. for spin-orbit potentials, it is the   ecis1506
                    integral of the form factor without derivation. thisecis1507
                    strength is of the same sign as the depth of the    ecis1508
                    standard description. for coulomb potentials, this  ecis1509
                    strength is the last value multiplied by            ecis1510
                    (2*l+1)*r**(l+1)/1.43998 . if nst is negative for a ecis1511
                    form factor copied, input of a multiplication factorecis1512
                    in next card.                                       ecis1513
                                                                        ecis1514
meaning of l1x, l2x and mlx for negative values of itypx (columns 36-40)ecis1515
************************************************************************ecis1516
      21-25   l1x   -l1x is the magnetic quantum number of the vibrationecis1517
                    when itypx=-6.                                      ecis1518
                    -l1x is the number of nodes when itypx=-7 or -8     ecis1519
                    (used only when mlx=0 or mlx=1).                    ecis1520
                    -l1x is the order of derivation of bessel functions ecis1521
                    or laguerre polynomials when itypx=-9 or -10.       ecis1522
      26-30   l2x   number of deformations when itypx=-5 or -6.         ecis1523
                    a division factor for the steps in computing bound  ecis1524
                    function (default value 4) when itypx=-8.           ecis1525
                    number of bessel functions or laguerre polynomials  ecis1526
                    when itypx=-9 or -10.                               ecis1527
      31-35   mlx   angular momentum of the vibration when itypx=-6.    ecis1528
                    number of bound functions when itypx=-7 or -8:      ecis1529
                    =0 or 1 for one function with the quantum numbers ofecis1530
                               the transition,                          ecis1531
                    =2 for two functions with the same itypx,           ecis1532
                    =3 when itypx=-8 for a laguerre polynomial for the  ecis1533
                               second function.                         ecis1534
                    l-value of bessel functions or laguerre polynomials ecis1535
                    when itypx=-9 or -10 (default option: angular       ecis1536
                    momentum of the form factor, enter a negative value ecis1537
                    to use 0).                                          ecis1538
  errors in this card stop the program.                                 ecis1539
                                                                        ecis1540
  note:  if there is no spin for the particle in all the channels, the  ecis1541
  ****  spin-orbit potentials (ityp = 5 , 6 and 8) are not read, but    ecis1542
        they are required as soon as there is at least a non spin-0     ecis1543
        particle at least for one level. for the transitions with a     ecis1544
        transfer of spin s which is not zero there are no spin-orbit    ecis1545
        potentials (no tensor term in dirac formalism). there is a      ecis1546
        coulomb potential for integral spin transfer even for l=0.      ecis1547
         volume and surface potentials are read separately except for   ecis1548
        itypx=-7 and -8. in the dirac formalism itypx=-7 and itypx=-8   ecis1549
        cannot be used. for magnetic coulomb interaction, only the      ecis1550
        coulomb potential is read. the form factors with itypx=-5 to -9 ecis1551
        can be copied only if they involve the same multipolarity. thereecis1552
        is no limitation for itypx=-7 and -8 if they involve two bound  ecis1553
        functions. the copied form factors can be folded differently.   ecis1554
                                                                        ecis1555

 allowed values of itypx for standard potentials                        ecis1556
 ***********************************************                        ecis1557
 *** ml = 0 ******                                                      ecis1558
 itypx =    -1    -2    -3    -4    -5    -6    -7    -8  -9,-10        ecis1559
 ityp = 1   yes   no    no    no    yes   no    no    no   yes          ecis1560
 ityp = 2   yes   no    no    no    yes   no    no    no   yes          ecis1561
 ityp = 3   yes   no    no    no    yes   no    no    no   yes          ecis1562
 ityp = 4   yes   no    no    no    yes   no    no    no   yes          ecis1563
 ityp = 5   yes   no    no    no    yes   no    no    no   yes          ecis1564
 ityp = 6   yes   no    no    no    yes   no    no    no   yes          ecis1565
 ityp = 7   yes   no    no    no    yes   no    no    no   yes          ecis1566
 ityp = 8   yes   no    no    no    yes   no    no    no   yes          ecis1567
 **** ml is not 0 ****                                                  ecis1568
 itypx =    -1    -2    -3    -4    -5    -6    -7    -8  -9,-10        ecis1569
 ityp = 1   yes   yes   yes   yes   yes   yes   yes   yes  yes          ecis1570
 ityp = 2   yes   yes   yes   yes   yes   yes   yes   yes  yes          ecis1571
 ityp = 3   yes   yes   yes   yes   yes   yes   no    no   yes          ecis1572
 ityp = 4   yes   yes   yes   yes   yes   yes   no    no   yes          ecis1573
 ityp = 5   yes   yes   yes   yes   yes   yes   no    no   yes          ecis1574
 ityp = 6   yes   yes   yes   yes   yes   yes   no    no   yes          ecis1575
 ityp = 7   no    yes   yes   yes   yes   yes   no    no   yes          ecis1576
 ityp = 8   no    yes   yes   yes   yes   yes   no    no   yes          ecis1577
                                                                        ecis1578
 number of parameters to store:                                         ecis1579
            10    10    10    10  11+l2x 13+l2x 11    22   13+l2x       ecis1580
 there is one more for coulomb potentials and itypx=-1 to -6.           ecis1581
 there are 5 more parameters for itypx=-7 and mlx=2.                    ecis1582
 there are 16 or 6 more parameters for itypx=-8 and mlx=2 or mlx=3.     ecis1583
                                                                        ecis1584
strength and scaling factor             format (7f10.5)                 ecis1585
***************************                                             ecis1586
  if itypx is negative go to 'parameters of standard form factors'.     ecis1587
  then if l1x is positive go back to 'identification' card.             ecis1588
          1   .true. to allow extrapolation beyond the last point. if itecis1589
              is .false., values beyond the last point will be 0.       ecis1590
       2-10   multiplicative factor for the strength (default value 1.).ecis1591
      11-20   multiplicative factor for the step size (default value 1.)ecis1592
                                                                        ecis1593
numerical values of the potentials      format (2(f10.5,f20.10),a4)     ecis1594
**********************************                                      ecis1595
       1-10   rext  radius.                                             ecis1596
      11-30   fext  value at rext.                                      ecis1597
      31-40   rext  radius.                                             ecis1598
      41-60   fext  value at rext.                                      ecis1599
      61-64   last  control word which must be 'last' for the last pointecis1600
       if this control word is not 'last' go to next such card.         ecis1601
  note:  the given radii must be in increasing order and their number   ecis1602
  ***** even. many points are needed for coulomb potential for which theecis1603
        extrapolation does not work well. if its depth is given by the  ecis1604
        integral, (nint not 0), these values describe the charge        ecis1605
        distribution.                                                   ecis1606
         the sign of the potentials is the one of their depth when      ecis1607
        woods-saxon form factors are used for schroedinger equations andecis1608
        for dirac equation.                                             ecis1609
         the spin-orbit 'central' have to be given as 1/r d/dr(v(r))    ecis1610
        except if its strength is defined by its integral or is folded. ecis1611
         the spin-orbit transition potentials have to be given as v(r), ecis1612
        from which 1/r d/dr(v(r)) and v(r)/r**2 are internally computed.ecis1613
                                                                        ecis1614

multiplicative factor                   format (7f10.5)                 ecis1615
*********************                                                   ecis1616
  if nint is not negative for a copied form factor go back to           ecis1617
'identification' card.                                                  ecis1618
       1-10   multiplicative factor for the strength (must not be 0.).  ecis1619
                                                                        ecis1620
parameters of standard form factors                                     ecis1621
***********************************                                     ecis1622
 only if l1x is not positive and itypx is negative, otherwise go to     ecis1623
 next 'identification card'.                                            ecis1624
                                                                        ecis1625
if itypx=-1 to -6:                                                      ecis1626
******************                                                      ecis1627
                                                                        ecis1628
parameters of the potential             format (7f10.5)                 ecis1629
***************************                                             ecis1630
       1-10   depth of potential.                                       ecis1631
              product of depth and deformation for a transition form    ecis1632
                  factor.                                               ecis1633
              product of charges for coulomb potential.                 ecis1634
              product of charges and deformation for coulomb transition ecis1635
                  form factor.                                          ecis1636
      11-20   radius of volume potential.                               ecis1637
      21-30   diffuseness of volume potential.                          ecis1638
      31-40   exponentiation factor (the form factor is at the power    ecis1639
                  1+this value).                                        ecis1640
      41-50   third parameter of a fermi charge distribution for a      ecis1641
              coulomb potential.                                        ecis1642
                                                                        ecis1643
deformations for itypx=-5 or -6         format (7f10.5)                 ecis1644
*******************************                                         ecis1645
       1-10   deformation for l=1.                                      ecis1646
      11-20   deformation for l=2.                                      ecis1647
      21-30   deformation for l=3.                                      ecis1648
      31-40   deformation for l=4.                                      ecis1649
      41-50   .......... and so on up to l2x ....                       ecis1650
  note:  odd and even deformations are used, starting by l=1.           ecis1651
  ****  the radii must be values already multiplied by a**(1/3).        ecis1652
        no check is done on product of charges when they are read or to ecis1653
        prevent a search on them.                                       ecis1654
                                                                        ecis1655
if itypx=-7 or -8:                                                      ecis1656
******************                                                      ecis1657
                                                                        ecis1658
quantum numbers                         format (12i5)                   ecis1659
***************                                                         ecis1660
if mlx=0 or mlx=1, the number of nodes is l2x and the quantum numbers   ecis1661
are those of the transition. in this case, go to next card.             ecis1662
if mlx=2 or mlx=3:                                                      ecis1663
       1- 5   np: number of nodes of the first bound function.          ecis1664
       6-10   lp: angular momentum of the first bound function.         ecis1665
      11-15   sp: value of 2*s for the first bound function.            ecis1666
      16-20   jp: value of 2*j for the first bound function.            ecis1667
      21-25   nh: number of nodes of the second bound function.         ecis1668
      26-30   lh: angular momentum of the second bound function.        ecis1669
      31-35   sh: value of 2*s for the second bound function.           ecis1670
      36-40   jh: value of 2*j for the second bound function.           ecis1671
      41-45   nvc not 0 to take into account particle-hole coupling     ecis1672
                  (used only with sp=1 and sh=1).                       ecis1673
                                                                        ecis1674

for itypx=-7:                           format (7f10.5)                 ecis1675
*************                                                           ecis1676
       1-10   oscillator parameter for the first bound function.        ecis1677
      11-20   oscillator parameter for the second bound function.       ecis1678
for mlx=0 or 1 or itypx=-8 with mlx=3, only the first parameter is read.ecis1679
for mlx=2, if the second parameter is 0., the first one is copied.      ecis1680
                                                                        ecis1681
for itypx=-8:                           format (7f10.5)                 ecis1682
*************                                                           ecis1683
       1-10   binding energy. if this value is negative, the bound stateecis1684
              is replaced by a scattering state normalised to           ecis1685
              sin(kr+delta) at infinity.                                ecis1686
      11-20   total mass.                                               ecis1687
      21-30   mass of bound particle (default value 1.).                ecis1688
      31-40   product of charges.                                       ecis1689
      41-50   real potential for unbound states or starting value for   ecis1690
              the search on bound state (default values 35 mev).        ecis1691
      51-60   reduced radius of real potential.                         ecis1692
      61-70   diffuseness of real potential.                            ecis1693
                                                                        ecis1694
on next card:                           format (7f10.5)                 ecis1695
*************                                                           ecis1696
       1-10   depth of spin-orbit potential.                            ecis1697
      11-20   reduced radius of spin-orbit potential.                   ecis1698
      21-30   diffuseness of spin-orbit potential.                      ecis1699
      31-40   reduced radius of coulomb potential.                      ecis1700
for mlx=2, go back to 'for itypx=-8:'.                                  ecis1701
for mlx=3, go back to 'for itypx=-7:' to read one oscillator parameter. ecis1702
  note:  reduced radii are used for itypx=-8.                           ecis1703
  ****  using the product of two bound functions, their coupling to the ecis1704
        angular momentum of the transition is computed by the code only ecis1705
        if their spins are both 1/2 and the nuclear matrix element      ecis1706
        should be the strength of the interaction. for spins not 1/2,   ecis1707
        this coupling should be included in the nuclear matrix element. ecis1708
                                                                        ecis1709
if itypx=-9 or -10:                                                     ecis1710
*******************                                                     ecis1711
                                                                        ecis1712
strengths                               format (7f10.5)                 ecis1713
*********                                                               ecis1714
        1-10   strength of the integral with r**(l+2). (for coulomb     ecis1715
               potentials and couplings, give the description of        ecis1716
               charge density or transition. the strength must be       ecis1717
               given. for potentials, it is the product of charges).    ecis1718
       11-20   for itypx=-9, radial extension of bessel function        ecis1719
               (default value matching radius).                         ecis1720
               for itypx=-10, parameter b of laguerre polynomial        ecis1721
               (default value 1). the potential is sum on n of          ecis1722
               x**l l(l+1/2,n,x**2) exp(-x**2/2) where x=r/b.           ecis1723
       21-30   strength of first bessel function/laguerre polynomial.   ecis1724
       31-40   strength of second bessel function/laguerre polynomial.  ecis1725
       41-50   strength of third bessel function/laguerre polynomial.   ecis1726
       51-60   strength of fourth bessel function/laguerre polynomial.  ecis1727
       61-70   strength of fifth bessel function/laguerre polynomial.   ecis1728
                                                                        ecis1729
 eventually, on next card:              format (7f10.5)                 ecis1730
 *************************                                              ecis1731
        1-10   strength of sixth bessel function/laguerre polynomial.   ecis1732
       11-20   strength of seventh bessel function/laguerre polynomial. ecis1733
       21-30   .......... and so on up to l2x ....                      ecis1734

  note:  with bessel function or laguerre polynomial or laguerre        ecis1735
  ****  polynomials, give the spin-orbit v(r) and never 1/r d/dr v(r).  ecis1736
  the laguerre polynomials are x**l exp(-x**2) l^(l+1/2)_n(2x**2) where ecis1737
  x=r/b (unnormalised polynomials as defined in bateman or abramowitz,  ecis1738
  with a parameter b inverse of the harmonic oscillator parameter).     ecis1739
     the program stops if form factors are missing.                     ecis1740
                                                                        ecis1741
folding parameters                      format (7e10.5)                 ecis1742
******************                                                      ecis1743
  if the maximum positive value of 'nfold' read in columns 46-50 of the ecis1744
identification cards is n, read n times:                                ecis1745
        1-10   val(25) 'v' parameter                                    ecis1746
       11-20   val(26) 'r' parameter                                    ecis1747
       21-30   val(27) 'a' parameter                                    ecis1748
for explanations, see 'cards read in subroutine lect'.                  ecis1749
                                                                        ecis1750
                                                                        ecis1751
cards read in subroutine eval                                           ecis1752
*****************************                                           ecis1753
   if lo(37)=.true., otherwise go to the beginning of another data set. ecis1754
                                                                        ecis1755
number of changes                       format (2l1,i3,i5,f10.5)        ecis1756
*****************                                                       ecis1757
          1   lo(37)     .true. for other calls to this subroutine      ecis1758
                         .false. for the last call.                     ecis1759
          2   lx         .true. to read another title                   ecis1760
       3- 5   nin        number of parameters to change.                ecis1761
       6-10   nex        indication for the use of the values to be readecis1762
                           >0  increments                               ecis1763
                           =0  new values                               ecis1764
                           <0  percentage of increase                   ecis1765
      11-20   ech        new search scale. (default option 20.)         ecis1766
                                                                        ecis1767
card 1                                  format (18a4)                   ecis1768
******                                                                  ecis1769
if lx=.true.  new title which will be printed as heading of results.    ecis1770
                                                                        ecis1771
identifications                         format (14i5)                   ecis1772
***************                                                         ecis1773
       1- 5   index of first parameter.                                 ecis1774
       6-10   index of second parameter.                                ecis1775
      11-15   ........................                                  ecis1776
          up to nin values, eventually on other cards, starting in 1-5. ecis1777
   note:  a negative value is replaced by zero.                         ecis1778
   ****   index zero is the total energy.                               ecis1779
          the other indices are the same as the ones used for search,   ecis1780
         with the limitations already described.                        ecis1781
                                                                        ecis1782
new values                              format (7f10.5)                 ecis1783
**********                                                              ecis1784
       1-10   first new parameter.                                      ecis1785
      11-20   second new parameter.                                     ecis1786
      21-30   ....................                                      ecis1787
  if lo(37)=.true. go again to 'cards read in subroutine eval'.         ecis1788
  if lo(37)=.false. go to the beginning of next data set.               ecis1789
  note:  there are different uses of this possibility:                  ecis1790
  *****  1) as a search stops usually before the minimum, it can be     ecis1791
        refined by using nex positive and introducing an increment '0.' ecis1792
        for any parameter, in search or not in search.                  ecis1793

         2) when searching the minimum of the chi2 as a function of someecis1794
        fixed parameter. the next search starts with the values of the  ecis1795
        parameters in search obtained in the last search.               ecis1796
         3) when some result must be obtained for different values of   ecis1797
        the parameters.                                                 ecis1798
                                                                        ecis1799
                                                                        ecis1800
restart input: cards read in subroutine rest                            ecis1801
********************************************                            ecis1802
                                                                        ecis1803
restart conditions                      format (l1,i4,i5,2f10.5)        ecis1804
******************                                                      ecis1805
          1   lo(35)  the only control which can be changed, all the    ecis1806
              others being those of last run.                           ecis1807
       2- 5   new maximum number of evaluations.                        ecis1808
       6-10   new value of nsec. (default value: the old one).          ecis1809
      11-20   new value of ech.                                         ecis1810
      11-20   new value of rap.                                         ecis1811
              if they are less than 1., ech or rap are not changed.     ecis1812
                                                                        ecis1813
                                                                        ecis1814
************************************************************************ecis1815
                                                                        ecis1816
                              *******************                       ecis1817
                              *  next data set  *                       ecis1818
                              *******************                       ecis1819
                                                                        ecis1820
      'fin' in columns 1-3 to stop the job without diagnostic.          ecis1821
                                                                        ecis1822
       for any trouble, write (and even send listings) to               ecis1823
     jacques raynal/service de physique theorique/c.e.-saclay           ecis1824
               91191 gif-sur-yvette cedex/france                        ecis1825
                                                                        ecis1826
     fax: (33)(1) 69.08-81-20                                           ecis1827
     e-mail: raynal@spht.saclay.cea.fr                                  ecis1828
                                                                        ecis1829
